function [zzero, ierr]=zerosUaz(a,L)
%---------------------------------------------
% Computation of the complex zeros of U(a,z)
%---------------------------------------------
% For a>0, the zeros are computed in the region 
%          where Im(z)>0 and Re(z) in [-L,0]
% For a<0, the zeros are computed in the region 
%          where Re(z)<0 and Im(z) in [-L,0]
%---------------------------------------------------------------
% Inputs:
%     a: parameter of the function U(a,z). 
%        Admissible values of a in the algorithm
%        are real values with |a|>0.2
%     L: Length of the interval that determines the 
%        spatial domain for locating the complex zeros. 
% Outputs:
%     zzero: array with the computed zeros.
%     ierr:  error flag indicating the success or issues 
%            in computation:
%               0: Computation successful
%               1: Computation failed due to one or 
%                  more input values being out of bounds 
%----------------------------------------------------------------
%  Matlab implementation of the algorithm described 
%  in the paper
%  "A numerical algorithm for computing the zeros of 
%   parabolic cylinder functions in the complex plane", 
%  by T.M. Dunster, A. Gil, D. Ruiz-Antolin, J. Segura
%---------------------------------------------------------------- 
ierr=0;
if abs(a)<=0.2
  ierr=1;
end
if L<0 
  ierr=1;
end      
if ierr==0
  if a>0 
    zzero=zerosUazapos(a,L);
  else
    zzero=zerosUazaneg(a,L);
  end
end  
end

function zzero=zerosUazapos(a,L)
%---------------------------------------------
% Computation of the complex zeros of U(a,z)
% for a>0 in a region with Im(z)>0 and
% Re(z) in [-L,0] 
%----------------------------------------------------
% The first zero is computed or approximated 
% using an  asymptotic aproximation in terms of the
% zeros of Airy functions given in
%  "Uniform asymptotic expansions for the
%  zeros of parabolic cylinder functions", by
%  T.M. Dunster, A. Gil, D. Ruiz-Antolin, 
%  J. Segura
%-----------------------------------------------------
epsilon=1e-15;
niter=100;
z=-L+1i*L;
A=0.5*(z*exp(-3*pi*1i/4))^2; 
B=-1i*log(pi^(-1/2)*2^(-a-1/2)*gamma(1/2+a)); 
m=floor(real(0.5*((A+B)/pi-0.5+a)));
zinit=zasympP(a,m);
zz=zinit;
zc(1)=(1i*zz)';
if a<=10 || m>8
  z=(1i*zinit)';
  delta=1+epsilon;
  it=0;
  while (delta>epsilon && it<niter)
    it=it+1;
    y=z; 
    z=Tpp(a,z);
    delta=abs(z-y)/abs(y);
  end
  zc(1)=z;
end  
zi=imag(zc(1));
if zi>0
  isi=1;
else
  isi=2;
end
j=1;
istop=0;
is=isi;
while (is==isi && istop==0)
 h=Hpp(a,zc(j));
 z0=zc(j);
 z=z0+h; 
 y0=0;
 y1=1;
 F=0; 
 delta=1+epsilon;
 it=0;
 while (delta>epsilon && it<niter)
   y=z; 
   [z,hn,s,sd]=Tptaylp(a,z0,h,y0,y1);
   y0=s;
   y1=sd;
   h=hn;
   z0=z;
   zz=z0+h;
   delta=abs(zz-y)/abs(y);
   it=it+1;
 end
 if isnan(zz)==0
   if (abs(imag(zz))<1e-16) || (it==niter) 
     istop=1; 
   else    
     zi=imag(zz);
     if zi>0
       is=1;
     else
       is=2;
     end
     if is==isi
       j=j+1;
       zc(j)=zz;
     end 
   end 
 else
   istop=1;  
 end  
end 
kl=0;
for i=1:j
  zz=(1i*zc(i))';
  if real(zz)>=-L
    kl=kl+1;
    zzero(kl)=zz;
  end  
end
end

function zzero=zerosUazaneg(a,L)
%--------------------------------------------------
% Computation of the complex zeros of U(a,z)
% for a<0 in a region with Im(z) in [0,L], Re(z)<0 
%---------------------------------------------------
% The first zero is computed or approximated 
% using an asymptotic aproximation in terms of the
% zeros of combinations of Airy functions 
% given in
%  "Uniform asymptotic expansions for the
%  zeros of parabolic cylinder functions", 
%  by T.M. Dunster, A. Gil, D. Ruiz-Antolin, 
%  J. Segura
%-------------------------------------------------
epsilon=1e-14;
niter=100;
aa=abs(a);
z=-L+1i*L;
A=0.5*(z*exp(-3*pi*1i/4))^2; 
B=-1i*log(pi^(-1/2)*2^(-aa-1/2)*gamma(1/2+aa)); 
m=floor(real(0.5*((A+B)/pi-0.5+aa)));
zinit=zasympN(aa,m)';
if aa<=10 || m>8
  z=zinit;
  delta=1+epsilon;
  it=0;
  while (delta>epsilon && it<niter)
    it=it+1;
    y=z; 
    z=Tp(a,z);
    delta=abs(z-y)/abs(y);
  end
  zinit=z;
end  
zc(1)=zinit;
zi=imag(zc(1));
if zi>0
  isi=1;
else
  isi=2;
end
j=1;
istop=0;
is=isi;
while (is==isi && istop==0)
  h=Hp(a,zc(j));
  z0=zc(j);
  z=z0+h; 
  y0=0;
  y1=1;
  delta=1+epsilon;
  it=0;
  while (delta>epsilon && it<niter)
    y=z; 
    [z,hn,s,sd]=Tptayl(a,z0,h,y0,y1);
    y0=s;
    y1=sd;
    h=hn;
    z0=z;
    zz=z0+h;
    delta=abs(zz-y)/abs(y);
    it=it+1;
  end
  if isnan(zz)==0
    if (abs(imag(zz))<1e-4) || (real(zz)>0) || (it==niter) 
      istop=1; 
    else     
      zi=imag(zz);
      if zi>0
        is=1;
      else
        is=2;
      end
      if is==isi
        j=j+1;
        zc(j)=zz;
      end 
    end
  else  
    istop=1;  
  end  
end
%Check that all zeros are inside the domain
kl=0;
for i=1:j
  if imag(zc(i))<L
    kl=kl+1;
    zzero(kl)=zc(i);
  end  
end
end

function T=Tpp(a,z)
%a positive
h=-1i*ucoci(a,1i*z);
coef=sqrt(-z*z/4+a);
T=z-1/coef*atan(coef*h);
end

function uc=ucoci(a,z)
%Computation of U(a,z)/U'(a,z)
[u,up]=uazcomp(a,z);
uc=u/up;    
end

function [z,hn,s,sd]=Tptaylp(a,zz,h,y0,y1)
%a positive
[s,sd]=step(a,1i*zz,1i*h,y0,y1);
H=-1i*s/sd;
z=zz+h;
coef=sqrt(-z*z/4+a);
hn=-1/coef*atan(coef*H);
end

function h=Hpp(a,z)   
%a positive
coef=sqrt(-z*z/4+a);
h=pi/coef;
end

function [s,sd]=step(a,z,h,y0,y1)
% Auxiliary routine for taylor
imax=25;       
onesix=1/6; 
xin=z;
h2=h*h;
h2d2=h2*0.5;
h3=h2*h;
xifac=xin*xin*0.25+a;
y2=xifac*y0;
y3=xifac*y1+z*0.5*y0;
s=y0+y1*h+y2*h2d2+y3*h3*onesix;
sd=y1+y2*h+y3*h2d2;
lt=h3*onesix;
ltd=h2*0.5;
for i=0:imax
  di=i;
  coun=di+4.0;
  cound=di+3.0;
  y4=xifac*y2+(di+2.0)*xin*0.5*y1+...
     (di+2.0)*(di+1.0)*0.25*y0;
  lt=lt*h/coun;
  ltd=ltd*h/cound;
  s=s+lt*y4;
  sd=sd+ltd*y4;
  y0=y1;
  y1=y2;
  y2=y3;
  y3=y4;
end
end

function zinit=zasympP(a,m)
global u akm
u=2*a;
akz=[-2.33810741045976703848919725245;
    -4.08794944413097061663698870146;
    -5.52055982809555105912985551293;
    -6.78670809007175899878024638450;
    -7.94413358712085312313828055580;
    -9.02265085334098038015819083988;
    -10.0401743415580859305945567374;
    -11.0085243037332628932354396496;
    -11.9360155632362625170063649029;
    -12.8287767528657572004067294072;
    -13.6914890352107179282956967795;
    -14.5278299517753349820739814430;
    -15.3407551359779968571462085135;
    -16.1326851569457714393459804472;
    -16.9056339974299426270352387706;
    -17.6613001056970575092536503040;
    -18.4011325992071154158613979295;
    -19.1263804742469521441241486897;
    -19.8381298917214997009475636160;
    -20.5373329076775663599826814113];
if m>20
  t=3.0*pi/8*(4.0*m-1.0);
  t2=t*t;
  t4=t2*t2;
  t6=t4*t2;
  t8=t6*t2;
  t10=t8*t2;
  akm=-t^(2.0/3.0)*(1.0+5/(48*t2)...
       -5.0/(36*t4)+77125.0/(82944*t6)...
       -108056875.0/(6967296*t8)+162375596875.0/(334430208.0*t10));
else
  akm=akz(m);  
end
preci=1e-14;
er=1;
z=2.2+2*1i;
while er>preci
  z2=z-f(z)/fp(z);
  er=abs(z-z2);
  z=z2;
end  
y=exp(pi*1i/3)/u^(2/3)*abs(akm);
x=sqrt(y/(z^2-1));
x2=x*x;
x3=x2*x;
x4=x3*x;
x5=x4*x;
x6=x5*x;
x7=x6*x;
x8=x7*x;
x9=x8*x;
x10=x9*x;
x11=x10*x;
x12=x11*x;
x13=x12*x;
x14=x13*x;
x15=x14*x;
x16=x15*x;
x17=x16*x;
x18=x17*x;
x19=x18*x;
x20=x19*x;
x21=x20*x;
x22=x21*x;
z2=z*z;
z3=z2*z;
z4=z3*z;
z5=z4*z;
z6=z5*z;
z7=z6*z;
z8=z7*z;
z9=z8*z;
z10=z9*z;
z11=z10*z;
z12=z11*z;
z13=z12*z;
z14=z13*z;
z15=z14*z;
z16=z15*z;
z17=z16*z;
z18=z17*z;
z19=z18*z;
z20=z19*z;
z21=z20*z;
y2=y*y;
y3=y2*y;
y4=y3*y;
y5=y4*y;
y6=y5*y;
y7=y6*y;
y8=y7*y;
y9=y8*y;
y10=y9*y;
y11=y10*y;
y12=y11*y;
y13=y12*y;
y14=y13*y;
y15=y14*y;
y16=y15*y;
y17=y16*y;
y18=y17*y;
y19=y18*y;
y20=y19*y;
y21=y20*y;
zm(1)=-5/24*x4/y2*z3+1/4*x2/y*z+5/48/y2*x;
zm(2)=-1105/1152*x10/y5*z9-175/1152*x10/y5*z7+221/64*x8/y4*z7+...
      25/64*x8/y4*z5-2949/640*x6/y3*z5+25/288*x7/y5*z4-29/96*x6/y3*z3+...
      259/96*x4/y2*z3-15/128*x5/y4*z2+1/16*x4/y2*z-19/32*x2/y*z-...
      25/4608*x4/y5*z+5/192*x3/y3+1105/9216*x/y5;
zm(3)=125/165888*x7/y8*z2-8125/41472*x16/y8*z11+4375/27648*x13/y8*z8-...
      875/27648*x10/y8*z5+293/384*x10/y5*z5-27/128*x8/y4*z3+...
      5375/110592*x8/y7*z3-185/1536*x7/y5*z2+1/64*x6/y3*z-19/64*x4/y2*z+...
      64475/82944*x14/y7*z9-1765/1536*x12/y6*z7-24125/55296*x11/y7*z6-...
      25/1536*x6/y6*z-71825/27648*x16/y8*z13+27625/27648*x13/y8*z10-...
      82825/3072*x16/y8*z15+5525/55296*x7/y8*z4-7735/2048*x11/y7*z8+...
      8291/1536*x9/y6*z6-64955/18432*x7/y5*z4+495/512*x5/y4*z2+...
      3315/256*x14/y7*z11-239627/9216*x12/y6*z9+612497/23040*x10/y5*z7-...
      571/40*x8/y4*z5+1397/384*x6/y3*z3+1205/3072*x9/y6*z4+...
      82825/512*x14/y7*z13-3250189/7168*x8/y4*z7+631/128*x2/y*z-...
      39551/768*x4/y2*z3-209571/512*x12/y6*z11+162353/288*x10/y5*z9+...
      539643/2560*x6/y3*z5-1105/8192*x5/y7*z2+82825/98304*x/y8-...
      5525/442368*x4/y8*z-95/1536*x3/y3-125/663552*x5/y7+5/768*x5/y4+1105/36864*x3/y6;
zm(4)=-40885/294912*x7/y8*z2+71327785/442368*x16/y8*z11-23033155/442368*x13/y8*z8+...
      5258185/1769472*x10/y8*z5-54251/2560*x10/y5*z5+2949/1024*x8/y4*z3-...
      218075/221184*x8/y7*z3+7745/6144*x7/y5*z2-57/512*x6/y3*z+2885/1024*x4/y2*z-...
      156083473/1105920*x14/y7*z9+11721/160*x12/y6*z7+6918647/221184*x11/y7*z6+...
      5425/49152*x6/y6*z+172900537/34560*x16/y8*z13-233620045/221184*x13/y8*z10+...
      5199436601/40960*x16/y8*z15-14355055/3538944*x7/y8*z4+...
      12993455/14336*x11/y7*z8-22726661/49152*x9/y6*z6+9676685/73728*x7/y5*z4-...
      70125/4096*x5/y4*z2-32537764097/5734400*x14/y7*z11+...
      21184600399/5160960*x12/y6*z9-480658489/258048*x10/y5*z7+...
      5082521/10240*x8/y4*z5-406981/6144*x6/y3*z3-29825/3072*x9/y6*z4-...
      5823225951/32768*x14/y7*z13+1253378667/28672*x8/y4*z7-...
      174317/2048*x2/y*z+151397/96*x4/y2*z3+2728968561/16384*x12/y6*z11-...
      10337060735/98304*x10/y5*z9-230733999/20480*x6/y3*z5+...
      36465/32768*x5/y7*z2+266305/589824/y9*x9*z4-4375/31850496/y11*x10*z3+...
      44875/5308416/y9*x9*z2-175/12288/y7*x8*z+1187875/10616832/y10*x8*z3+...
      414125/589824/y11*x7*z4+8125/127401984/y10*x8*z+27625/10616832/y11*x7*z2-...
      5525/147456/y9*x6*z-248475/262144/y10*x5*z2-16129525/169869312/y11*x4*z+...
      1282031525/88080384/y11*x-1282031525/688128/y11*x22*z21-...
      306460975/2654208/y11*x22*z19+256406305/16384/y10*x20*z19-...
      524875/82944/y11*x22*z17+41936765/49152/y10*x20*z17-...
      154375/497664/y11*x22*z15-1912484403/32768/y9*x18*z17+...
      53564875/1327104/y10*x20*z15+414125/9216/y11*x19*z16-...
      404256865/147456/y9*x18*z15+13254625/7962624/y10*x20*z13+...
      359125/82944/y11*x19*z14-251075/2304/y9*x18*z13-...
      4555375/16384/y10*x17*z14+40625/124416/y11*x19*z12-...
      602125/165888/y9*x18*z11-29730025/1327104/y10*x17*z12+...
      17957885/24576/y9*x15*z12-675875/497664/y10*x17*z10+28325/6912/y8*x16*z9-...
      1795625/2654208/y11*x16*z11+872555/18432/y9*x15*z10-...
      284375/2654208/y11*x16*z9+957775/442368/y9*x15*z8-...
      23195/9216/y7*x14*z7+14248975/5308416/y10*x14*z9+...
      6105125/5308416/y11*x13*z10+1676875/5308416/y10*x14*z7-...
      13375/8192/y8*x13*z6+4921/6144/y6*x12*z5+966875/5308416/y11*x13*z8-...
      201715/49152/y9*x12*z7-1709435/393216/y10*x11*z8+21875/1990656/y11*x13*z6-...
      70825/221184/y9*x12*z5+10565/18432/y7*x11*z4-85/768/y5*x10*z3-...
      5331625/10616832/y10*x11*z6+1832311/294912/y9*x9*z6-75625/3981312/y10*x11*z4+...
      6175/49152/y8*x10*z3-155/2048/y6*x9*z2+1/256/y4*x8*z-...
      193375/2654208/y11*x10*z5+5/3072/y5*x7-125/221184/y8*x7-...
      27625/42467328/y10*x5+82825/393216/y9*x3+3155/6144*x3/y3+...
      1105/147456*x5/y7-95/3072*x5/y4-20995/294912*x3/y6;
sumz=0;
for i=1:4
  sumz=sumz+zm(i)/u^(2*i);
end    
zhat=z+sumz;
zinit=1i*sqrt(2*u)*zhat;
end

function y=f(z)
global u akm
y=z*sqrt(z^2-1)-log(z+sqrt(z^2-1))-4*1i/3/u*abs(akm)^(3/2);
end

function y=fp(z)
y=2*sqrt(z^2-1);
end

function T=Tp(a,z)
%a negative
h=ucoci(a,z);
coef=sqrt(-z*z/4-a);
T=z-1/coef*atan(coef*h);
end

function [z,hn,s,sd]=Tptayl(a,zz,h,y0,y1)
%a negative
[s,sd]=step(a,zz,h,y0,y1);
H=s/sd;
z=zz+h;
coef=sqrt(-z*z/4-a);
hn=-1/coef*atan(coef*H);
end

function h=Hp(a,z)   
%a negative
coef=sqrt(-z*z/4-a);
h=pi/coef;
end

function zinit=zasympN(a,m)
global u z akm
zinit=0;
akm=0;
u=2*a;
if cos(pi*u/2)>0 
  nn=floor((u+1)/4);
  tau=4*m+4*nn-u-1+2*1i/pi*log(2*cos(u*pi/2));  
else 
  nn=floor((u-1)/4);
  tau=4*m+4*nn-u+1+2*1i/pi*log(2*abs(cos(u*pi/2)));
end 
t=3/8*pi*tau;
t2=t*t; t4=t2*t2; t6=t4*t2;
t8=t4*t4; t10=t8*t2;
TTT=t^(2/3)*(1+5/(48*t2)-5/(36*t4)+77125/(82944*t6)-...
    108056875/(6967296*t8)+162375596875/334430208/t10);
am=exp(pi*1i/3)*TTT;
z=am;
delta=0;
preci=1e-14;
if m<25  
  er=1;
  delta=1e-8+1e-8*1i;
  while er>preci
    delta2=delta-fdelta(delta)/fdeltap(delta);
    er=abs(delta-delta2);
    delta=delta2;
  end
end    
akm=am+delta;
z=akm;
er=1;
while er>preci
  z2=z-fn(z)/fnp(z);
  er=abs(z-z2)/abs(z);
  z=z2;
end  
y=1/u^(2/3)*akm;
x=sqrt(y/(z^2-1));
x2=x*x;
x3=x2*x;
x4=x3*x;
x5=x4*x;
x6=x5*x;
x7=x6*x;
x8=x7*x;
x9=x8*x;
x10=x9*x;
x11=x10*x;
x12=x11*x;
x13=x12*x;
x14=x13*x;
x15=x14*x;
x16=x15*x;
x17=x16*x;
x18=x17*x;
x19=x18*x;
x20=x19*x;
x21=x20*x;
x22=x21*x;
z2=z*z;
z3=z2*z;
z4=z3*z;
z5=z4*z;
z6=z5*z;
z7=z6*z;
z8=z7*z;
z9=z8*z;
z10=z9*z;
z11=z10*z;
z12=z11*z;
z13=z12*z;
z14=z13*z;
z15=z14*z;
z16=z15*z;
z17=z16*z;
z18=z17*z;
z19=z18*z;
z20=z19*z;
z21=z20*z;
y2=y*y;
y3=y2*y;
y4=y3*y;
y5=y4*y;
y6=y5*y;
y7=y6*y;
y8=y7*y;
y9=y8*y;
y10=y9*y;
y11=y10*y;
y12=y11*y;
y13=y12*y;
y14=y13*y;
y15=y14*y;
y16=y15*y;
y17=y16*y;
y18=y17*y;
y19=y18*y;
y20=y19*y;
y21=y20*y;
% 
zm(1)=-5/24*x4/y2*z3+1/4*x2/y*z+5/48/y2*x;
zm(2)=-1105/1152*x10/y5*z9-175/1152*x10/y5*z7+221/64*x8/y4*z7+...
      25/64*x8/y4*z5-2949/640*x6/y3*z5+25/288*x7/y5*z4-29/96*x6/y3*z3+...
      259/96*x4/y2*z3-15/128*x5/y4*z2+1/16*x4/y2*z-19/32*x2/y*z-...
      25/4608*x4/y5*z+5/192*x3/y3+1105/9216*x/y5;
zm(3)=125/165888*x7/y8*z2-8125/41472*x16/y8*z11+4375/27648*x13/y8*z8-...
      875/27648*x10/y8*z5+293/384*x10/y5*z5-27/128*x8/y4*z3+...
      5375/110592*x8/y7*z3-185/1536*x7/y5*z2+1/64*x6/y3*z-...
      19/64*x4/y2*z+64475/82944*x14/y7*z9-1765/1536*x12/y6*z7-...
      24125/55296*x11/y7*z6-25/1536*x6/y6*z-71825/27648*x16/y8*z13+...
      27625/27648*x13/y8*z10-82825/3072*x16/y8*z15+5525/55296*x7/y8*z4-...
      7735/2048*x11/y7*z8+8291/1536*x9/y6*z6-64955/18432*x7/y5*z4+...
      495/512*x5/y4*z2+3315/256*x14/y7*z11-239627/9216*x12/y6*z9+...
      612497/23040*x10/y5*z7-571/40*x8/y4*z5+1397/384*x6/y3*z3+...
      1205/3072*x9/y6*z4+82825/512*x14/y7*z13-3250189/7168*x8/y4*z7+...
      631/128*x2/y*z-39551/768*x4/y2*z3-209571/512*x12/y6*z11+...
      162353/288*x10/y5*z9+539643/2560*x6/y3*z5-1105/8192*x5/y7*z2+...
      82825/98304*x/y8-5525/442368*x4/y8*z-95/1536*x3/y3-...
      125/663552*x5/y7+5/768*x5/y4+1105/36864*x3/y6;
zm(4)=-40885/294912*x7/y8*z2+71327785/442368*x16/y8*z11-...
      23033155/442368*x13/y8*z8+5258185/1769472*x10/y8*z5-...
      54251/2560*x10/y5*z5+2949/1024*x8/y4*z3-218075/221184*x8/y7*z3+...
      7745/6144*x7/y5*z2-57/512*x6/y3*z+2885/1024*x4/y2*z-...
      156083473/1105920*x14/y7*z9+11721/160*x12/y6*z7+...
      6918647/221184*x11/y7*z6+5425/49152*x6/y6*z+172900537/34560*x16/y8*z13-...
      233620045/221184*x13/y8*z10+5199436601/40960*x16/y8*z15-...
      14355055/3538944*x7/y8*z4+12993455/14336*x11/y7*z8-...
      22726661/49152*x9/y6*z6+9676685/73728*x7/y5*z4-...
      70125/4096*x5/y4*z2-32537764097/5734400*x14/y7*z11+...
      21184600399/5160960*x12/y6*z9-480658489/258048*x10/y5*z7+...
      5082521/10240*x8/y4*z5-406981/6144*x6/y3*z3-29825/3072*x9/y6*z4-...
      5823225951/32768*x14/y7*z13+1253378667/28672*x8/y4*z7-...
      174317/2048*x2/y*z+151397/96*x4/y2*z3+...
      2728968561/16384*x12/y6*z11-10337060735/98304*x10/y5*z9-...
      230733999/20480*x6/y3*z5+36465/32768*x5/y7*z2+...
      266305/589824/y9*x9*z4-4375/31850496/y11*x10*z3+...
      44875/5308416/y9*x9*z2-175/12288/y7*x8*z+1187875/10616832/y10*x8*z3+...
      414125/589824/y11*x7*z4+8125/127401984/y10*x8*z+...
      27625/10616832/y11*x7*z2-5525/147456/y9*x6*z-...
      248475/262144/y10*x5*z2-16129525/169869312/y11*x4*z+...
      1282031525/88080384/y11*x-1282031525/688128/y11*x22*z21-...
      306460975/2654208/y11*x22*z19+256406305/16384/y10*x20*z19-...
      524875/82944/y11*x22*z17+41936765/49152/y10*x20*z17-...
      154375/497664/y11*x22*z15-1912484403/32768/y9*x18*z17+...
      53564875/1327104/y10*x20*z15+414125/9216/y11*x19*z16-...
      404256865/147456/y9*x18*z15+13254625/7962624/y10*x20*z13+...
      359125/82944/y11*x19*z14-251075/2304/y9*x18*z13-...
      4555375/16384/y10*x17*z14+40625/124416/y11*x19*z12-...
      602125/165888/y9*x18*z11-29730025/1327104/y10*x17*z12+...
      17957885/24576/y9*x15*z12-675875/497664/y10*x17*z10+...
      28325/6912/y8*x16*z9-1795625/2654208/y11*x16*z11+...
      872555/18432/y9*x15*z10-284375/2654208/y11*x16*z9+...
      957775/442368/y9*x15*z8-23195/9216/y7*x14*z7+...
      14248975/5308416/y10*x14*z9+6105125/5308416/y11*x13*z10+...
      1676875/5308416/y10*x14*z7-13375/8192/y8*x13*z6+...
      4921/6144/y6*x12*z5+966875/5308416/y11*x13*z8-...
      201715/49152/y9*x12*z7-1709435/393216/y10*x11*z8+...
      21875/1990656/y11*x13*z6-70825/221184/y9*x12*z5+...
      10565/18432/y7*x11*z4-85/768/y5*x10*z3-...
      5331625/10616832/y10*x11*z6+1832311/294912/y9*x9*z6-...
      75625/3981312/y10*x11*z4+6175/49152/y8*x10*z3-...
      155/2048/y6*x9*z2+1/256/y4*x8*z-193375/2654208/y11*x10*z5+...
      5/3072/y5*x7-125/221184/y8*x7-27625/42467328/y10*x5+...
      82825/393216/y9*x3+3155/6144*x3/y3+1105/147456*x5/y7-...
      95/3072*x5/y4-20995/294912*x3/y6;
sumz=0;
for i=1:4
  sumz=sumz+zm(i)/u^(2*i);
end    
zhat=z+sumz;
zinit=-sqrt(2*u)*zhat;
end

function y=fn(zz)
global u z akm
zz2=zz^2;
y=zz*((1-1/zz2)^(1/2)-log(zz)/zz2-...
  log(1+(1-1/zz2)^(1/2))/zz2)^(1/2)-...
  (2/3)*3^(1/2)*(1/u)^(1/2)*akm^(3/4);
end  

function y=fnp(zz)
global u z akm
zz2=zz^2;
y=(((zz2-1)/zz2)^(1/2)*zz2+zz2-1)/(zz2*(-(-((zz2-1)/zz2)^(1/2)*zz2+log(zz)+...
  log(1+((zz2-1)/zz2)^(1/2)))/zz2)^(1/2)*(1+((zz2-1)/zz2)^(1/2)));
end  

function y=fdelta(delta)
global u z akm
y=1+airy((-1/2-((1/2)*1i)*3^(1/2))*(z+delta))*exp(((1/3)*1i)*pi*...
  (3*u-1))/airy((-1/2+((1/2)*1i)*3^(1/2))*(z+delta));
end  

function y=fdeltap(delta)
global u z akm
y=-(1/2)*exp(((1/3)*1i)*pi*(3*u-1))*...
   (1i*airy(1,-(1/2)*(1i*3^(1/2)+1)*(z+delta))*...
    airy((1/2)*(1i*3^(1/2)-1)*(z+delta))*3^(1/2)+...
    1i*airy(-(1/2)*(1i*3^(1/2)+1)*(z+delta))*...
    airy(1,(1/2)*(1i*3^(1/2)-1)*(z+delta))*3^(1/2)+...
    airy(1,-(1/2)*(1i*3^(1/2)+1)*(z+delta))*...
    airy((1/2)*(1i*3^(1/2)-1)*(z+delta))-...
    airy(-(1/2)*(1i*3^(1/2)+1)*(z+delta))*...
    airy(1,(1/2)*(1i*3^(1/2)-1)*(z+delta)))/...
   airy((1/2)*(1i*3^(1/2)-1)*(z+delta))^2;
end  

function [u,up]=uazcomp(a,z)
phase=angle(z);
rez=real(z);
imz=imag(z);
if phase>pi/2 && a>18 && abs(rez)>15 && abs(imz)>15
  u=UazLG(a,z);
  up=UazLGp(a,z);
else    
  u=uaz(a,z);
  up=0.5*z*u-uaz(a-1,z);
end  
end

function u=uaz(a,z)
%------------------------------------------------------
%Computation of the parabolic cylinder function U(a,z)
%Algorithm based on the methods described in
% "Computation of parabolic cylinder functions having 
% complex argument". T. M. Dunster, A. Gil, J. Segura. 
% Appl. Numer. Math. 197 (2024)  230-242
%------------------------------------------------------    
fla=0;
phase=angle(z);
if phase<0
    z=conj(z);
    fla=1;
    phase=-phase;
end
if phase>pi/2
   f1=-1i*exp(-1i*pi*a);
   f2=sqrt(2*pi)/gamma(a+1/2)*exp((1-2*a)/4*pi*1i);
   u1=conj(uazprin(a,-conj(z)));
   u2=uazprin(-a,-1i*z);
   u=f1*u1+f2*u2;
else
   u=uazprin(a,z);
end    
if fla==1
   u=conj(u);
end    
end

function u=uazprin(a,z)
zabs=abs(z);aabs=abs(a);
if zabs>12+5*aabs/30
    u=poincaru(a,z);
elseif aabs>15
    if a>0
        u=asimpp(a,z);
    else
        u=asimpn(a,z);
    end
else
    u=integral(a,z);
end
end

function Uaz=asimpp(aa,www)
if abs(imag(www))<1e-300
  w=www+1e-300*1i;
else
  w=www;
end  
u=2*aa;
z=-1i*w/sqrt(2*u);
m=8;
E1(1)=-0.41666666666666666667e-1;
E1(2)= 0.;
E1(3)= 0.97222222222222222222e-2;
E1(4)= 0.;
E1(5)= -0.12301587301587301587e-1;
E1(6)= 0.;
E1(7)= 0.37797619047619047619e-1;
E1(8)= 0.;
E1(9)= -.21506734006734006734;
E1(10)= 0.;
E1(11)= 1.9625888000888000888;
E1(12)= 0.;
E1(13)= -26.253205128205128205;
E1(14)= 0.;
E1(15)= 484.14313316993464052;
E1(16)= 0.;
E1(17)= -11773.083765377496028;
E1(18)= 0.;
E1(19)= 365017.05485247208931;
E1(20)= 0.;
E1(21)= -14053914.866545893720;
E1(22)= 0.;
E1(23)= 657869309.17583645220;
E1(24)= 0.;
E1(25)= -36794167237.101666667;
coefsum5=E1(1)/u;
for j=1:m
  coefsum5=coefsum5+E1(2*j+1)/u^(2*j+1);   
end
[Acoef,Bcoef]=ABcomplecoef(u,z);
if abs(z)>1 
  z2=z*z;  
  zetaf=z^(4/3)*((3/4)*(sqrt(1-1/z2)-(1/z2)*log(1+sqrt(1-1/z2))-log(z)/z2))^(2/3);
else
  zetaf=- ((3/4)*(acos(z)-z*sqrt(1-z*z)))^(2/3);
end
factorU=sqrt(pi)*2^(3/4+u/4)*u^(-u/4-1/12);
a1m=airy(u^(2/3)*zetaf*exp(1i*2*pi/3));
u^(2/3)*zetaf*exp(1i*2*pi/3);
a1mp=exp(2*1i*pi/3)*airy(1,u^(2/3)*zetaf*exp(1i*2*pi/3));
wmm1=a1m*Acoef+a1mp*Bcoef; 
Uaz=factorU*exp(u/4-pi*1i*u/4-pi*1i/12-coefsum5)*wmm1;  
end

function [Acoef,Bcoef]=ABcomplecoef(u,z)
dis=0.95;
if abs(z-1)<dis
  kc=1;
  r=1.0;
  zc=1.0;
  theta=0.;
  np=2000;
  delta=2*pi/np;
  for i=1:np  
    zz=zc+r*exp(1i*theta);    
    zzz(i)=zz; 
    [Aco,Bco]=ABcoefs(u,zz);
    Aa(i)=Aco;
    Bb(i)=Bco;
    thet(i)=theta;
    theta=theta+delta;
  end  
  sumaA=0; sumaB=0; sumpru=0;
  for i=1:np
   sumaB=sumaB+Bb(i)/(zzz(i)-z)*(zzz(i)-zc);
   sumaA=sumaA+Aa(i)/(zzz(i)-z)*(zzz(i)-zc);
  end
  inteB=sumaB/np;
  inteA=sumaA/np;
  Acoef=inteA; 
  Bcoef=inteB;
else
  kc=0;  
  [Acoef,Bcoef]=ABcoefs(u,z);
end  
end  
function [Acoef,Bcoef,xi]=ABcoefs(u,z)
N=25;
m=8;
%a coeffs
a(1)=5/72;
a(2)=5/72;
for i=2:N 
   cc=0;
   for j=1:i-1  
      cc=cc+a(j)*a(i-j);
   end
   a(i+1)=((i+1)*a(i)+cc)/2;
end
%ag coeffs
ag(1)=-7/72;
ag(2)=-7/72;
for i=2:N 
   cc=0;
   for j=1:i-1  
      cc=cc+ag(j)*ag(i-j);
   end
   ag(i+1)=((i+1)*ag(i)+cc)/2;
end
nu=u;
zargum=z;
z2=z*z;
z2m1=z2-1;
sqz2m1=sqrt(z2m1);
xi=(1/2)*(z*sqz2m1-log(z+sqz2m1));
if abs(z)>=1
  beta=1/sqrt(1-1/z2);
else
  if (imag(z)>=0)  
    beta=-1i*z/sqrt(1-z2);
  else
    beta=1i*z/sqrt(1-z2); 
  end    
end    
%E coeffs parabolic    
beta2=beta*beta; 
beta3=beta2*beta;   beta4=beta3*beta; beta5=beta4*beta; 
beta6=beta5*beta;   beta7=beta6*beta; beta8=beta7*beta; 
beta9=beta8*beta;   beta10=beta9*beta; beta11=beta10*beta; 
beta12=beta11*beta; beta13=beta12*beta; beta14=beta13*beta; 
beta15=beta14*beta; beta16=beta15*beta; beta17=beta16*beta; 
beta18=beta17*beta; beta19=beta18*beta; beta20=beta19*beta; 
beta21=beta20*beta; beta22=beta21*beta; beta23=beta22*beta; 
beta24=beta23*beta; beta25=beta24*beta; beta26=beta25*beta; 
beta27=beta26*beta; beta28=beta27*beta; beta29=beta28*beta; 
beta30=beta29*beta; beta31=beta30*beta; beta32=beta31*beta; 
beta33=beta32*beta; beta34=beta33*beta; beta35=beta34*beta; 
beta36=beta35*beta; beta37=beta36*beta; beta38=beta37*beta; 
beta39=beta38*beta; beta40=beta39*beta; beta41=beta40*beta; 
beta42=beta41*beta; beta43=beta42*beta; beta44=beta43*beta;
beta45=beta44*beta; beta46=beta45*beta; beta47=beta46*beta; 
beta48=beta47*beta; beta49=beta48*beta; beta50=beta49*beta; 
beta51=beta50*beta; beta52=beta51*beta; beta53=beta52*beta; 
beta54=beta53*beta; beta55=beta54*beta; beta56=beta55*beta;
beta57=beta56*beta; beta58=beta57*beta; beta59=beta58*beta; 
beta60=beta59*beta; beta61=beta60*beta; beta62=beta61*beta; 
beta63=beta62*beta; beta64=beta63*beta; beta65=beta64*beta; 
beta66=beta65*beta; beta67=beta66*beta; beta68=beta67*beta;
beta69=beta68*beta; beta70=beta69*beta; beta71=beta70*beta; 
beta72=beta71*beta; beta73=beta72*beta; beta74=beta73*beta;
beta75=beta74*beta; 
E(1)=0.416666666666666666666666666667e-1*beta*(5.*beta2-6.);
E(2)=0.625000000000000000000000000000e-1*(beta2-1.)^2*(5.*beta2-2.);
E(3)=.959201388888888888888888888889*beta9-...
      3.45312500000000000000000000000*beta7+...
      4.60781250000000000000000000000*beta5-...
      2.69791666666666666666666666667*beta3+.593750000000000000000000000000*beta;
E(4)=4.41406250000000000000000000000*beta12-...
     21.1875000000000000000000000000*beta10+...
     40.9218750000000000000000000000*beta8-...
     40.0937500000000000000000000000*beta6+...
     20.4140625000000000000000000000*beta4-...
     4.78125000000000000000000000000*beta2+.312500000000000000000000000000;
E(5)=26.9612630208333333333333333333*beta15-...
     161.767578125000000000000000000*beta13+...
     409.318359375000000000000000000*beta11-...
     563.725694444444444444444444444*beta9+...
     453.430385044642857142857142857*beta7-...
     210.798046875000000000000000000*beta5+...
     51.4986979166666666666666666667*beta3-4.92968750000000000000000000000*beta;
E(6)=204.947916666666666666666666667*beta18-...
     1475.62500000000000000000000000*beta16+...
     4618.30078125000000000000000000*beta14-...
     8201.30468750000000000000000000*beta12+...
     9035.07421875000000000000000000*beta10-...
     6326.01562500000000000000000000*beta8+...
     2758.26171875000000000000000000*beta6-...
     694.804687500000000000000000000*beta4+...
     83.7070312500000000000000000000*beta2-2.54166666666666666666666666667;
E(7)=85.1157226562500000000000000000*beta+...
     105154.019521077473958333333333*beta9-...
     43714.3787318638392857142857143*beta7+...
     11266.3085449218750000000000000*beta5-...
     1577.05208333333333333333333333*beta3-...
     126939.370141601562500000000000*beta15+...
     177710.752899169921875000000000*beta13-...
     166563.022521972656250000000000*beta11+...
     1863.07129632859002976190476190*beta21-...
     15649.7988891601562500000000000*beta19+58364.3921813964843750000000000*beta17;
E(8)=-2477.23242187500000000000000000*beta2+...
     3487255.09863281250000000000000*beta12-...
     2031372.96679687500000000000000*beta10+...
     813921.954345703125000000000000*beta8-...
     213503.751953125000000000000000*beta6+...
     33244.5029296875000000000000000*beta4-...
     2108672.91015625000000000000000*beta18+...
     3582215.64404296875000000000000*beta16-...
     4210267.09570312500000000000000*beta14+...
     19708.9660644531250000000000000*beta24-...
     189206.074218750000000000000000*beta22+...
     819110.583984375000000000000000*beta20+43.2812500000000000000000000000;
E(9)=-2501.43835449218750000000000000*beta-...
     17415421.3852700127495659722222*beta9+...
     4632797.31045532226562500000000*beta7-...
     781299.891906738281250000000000*beta5+...
     71993.5012003580729166666666667*beta3+...
     109154677.896041870117187500000*beta15-...
     81954741.3416748046875000000000*beta13+...
     44759535.8692859302867542613636*beta11-...
     37654805.4763590494791666666667*beta21+...
     75232625.2479476928710937500000*beta19-...
     106373634.234054565429687500000*beta17+...
     237850.700925897668909143518519*beta27-...
     2568787.56999969482421875000000*beta25+12661710.5966949462890625000000*beta23;
E(10)=111232.146972656250000000000000*beta2-...
     1108552879.86425781250000000000*beta12+...
     421128957.611279296875000000000*beta10-...
     113310599.031738281250000000000*beta8+...
     20335320.2656250000000000000000*beta6-...
     2182922.41406250000000000000000*beta4+...
     3356610252.02734375000000000000*beta18-...
     3088027191.64746093750000000000*beta16+...
     2139956710.43774414062500000000*beta14-...
     721862621.848144531250000000000*beta24+...
     1658346147.20947265625000000000*beta22-...
     2741050372.20468750000000000000*beta20+...
     3225059.84497070312500000000000*beta30-...
     38700718.1396484375000000000000*beta28+...
     213974888.631591796875000000000*beta26-1263.02500000000000000000000000;
E(11)=111920.1949*beta+3085120100.*beta9-...
     581996200.6*beta7+70157248.15*beta5-4611098.768*beta3-...
     0.6153607495e11*beta15+0.3049958938e11*beta13-...
     0.1135846460e11*beta11+0.1036337171e12*beta21-...
     0.1129303279e12*beta19+0.9493429829e11*beta17-...
     0.1481862973e11*beta27+0.3848124070e11*beta25-...
     0.7280910459e11*beta23+48543036.19*beta33-...
     640768077.7*beta31+3927199353.*beta29;
E(12)= -7060073.908*beta2+0.3380972893e12*beta12-...
     0.9256409331e11*beta10+0.1819188569e11*beta8-...
     2403059790.*beta6+190009696.9*beta4-...
     0.3157292573e13*beta18+0.1933847987e13*beta16-...
     0.9232167883e12*beta14+0.3252890979e13*beta24-...
     0.4097994257e13*beta22+0.4052272383e13*beta20-...
     0.3247740029e12*beta30+0.9406798639e12*beta28-...
     0.2004980936e13*beta26+803186730.9*beta36-...
     0.1156588892e11*beta34+0.7782501964e11*beta32+56307.60417;
E(13)=-7089958.780*beta+0.1449032864e11*beta39-...
     0.6172141195e12*beta9-0.2260491267e12*beta37+...
     0.8781396975e11*beta7+0.1656668662e13*beta35-...
     8000733749.*beta5+395501096.5*beta3+...
     0.3049866179e14*beta15-0.1100992808e14*beta13+...
     0.3034781400e13*beta11-0.1549010763e15*beta21+...
     0.1130918282e15*beta19-0.6597760377e14*beta17+...
     0.1045736977e15*beta27-0.1495568359e15*beta25+...
     0.1701077814e15*beta23-0.7575890725e13*beta33+...
     0.2421319015e14*beta31-0.5740670331e14*beta29;
E(14)=602266918.0*beta2-0.1079559615e15*beta12+...
     0.2260384042e14*beta10-0.3420153835e13*beta8+...
     0.3488179126e12*beta6-0.2125041725e11*beta4+...
     0.2429602541e16*beta18-0.1092080833e16*beta16+...
     0.3893716733e15*beta14-0.7422818013e16*beta24+...
     0.6295862491e16*beta22-0.4344611527e16*beta20+...
     0.2830991783e12*beta42-0.4756066195e13*beta40+...
     0.3770973995e14*beta38-3560017.518+...
     0.3458461523e16*beta30-0.5535980089e16*beta28+...
     0.7120648489e16*beta26-0.1875241489e15*beta36+...
     0.6555489710e15*beta34-0.1711273741e16*beta32;
E(15)=604121814.0*beta-0.4911442846e16*beta39+...
     0.1417053690e15*beta9+0.1864177044e17*beta37-...
     0.1584907343e14*beta7-0.5313036598e17*beta35+...
     0.1134624724e13*beta5-0.4381689568e11*beta3-...
     0.1486188264e17*beta15+0.4141617137e16*beta13-...
     0.8891261324e15*beta11+0.1783131717e18*beta21-...
     0.9607939929e17*beta19+0.4213834451e17*beta17-...
     0.3522923511e18*beta27+0.3405329064e18*beta25-...
     0.2714809670e18*beta23+0.1179731705e18*beta33-...
     0.2089776209e18*beta31+0.2999423116e18*beta29+...
     0.5954671150e13*beta45-0.1071840807e15*beta43+0.9141452529e15*beta41;
E(16)=-0.6648971579e11*beta2+0.3739880512e17*beta12-...
     0.6231463745e16*beta10+0.7527848719e15*beta8-...
     0.6132689600e14*beta6+0.2974530207e13*beta4-...
     0.1743171154e19*beta18+0.6089515299e18*beta16-...
     0.1704613412e18*beta14+0.1239078696e20*beta24-...
     0.7790655103e19*beta22+0.4061937279e19*beta20-...
     0.1671691705e20*beta30+0.1814335249e20*beta28-...
     0.1641465045e20*beta26+0.4156773081e19*beta36-...
     0.8073305479e19*beta34+0.1279192380e20*beta32-...
     0.1357454608e18*beta42+0.5559293533e18*beta40-...
     0.1717683753e19*beta38+0.1341656582e15*beta48-...
     0.2575980637e16*beta46+0.2351540543e17*beta44+302992377.3;
E(17)=-0.6664572055e11*beta-0.3742041297e17*beta9+...
     0.3390526387e16*beta7-0.1962895600e15*beta5+...
     0.6094029671e13*beta3+0.7492620607e19*beta15-...
     0.1675511412e19*beta13+0.2901389241e18*beta11-...
     0.1828583524e21*beta21+0.7696804165e20*beta19-...
     0.2666029131e20*beta17+0.8305064451e21*beta27-...
     0.5972129247e21*beta25+0.3611593011e21*beta23-...
     0.7983138888e21*beta33+0.9613615991e21*beta31-...
     0.9733558995e21*beta29+0.1513952498e21*beta39-...
     0.3199131040e21*beta37+0.5546581845e21*beta35-...
     0.3949329014e19*beta45+0.1735812650e20*beta43-...
     0.5779346632e20*beta41+0.6398229506e18*beta47+...
     0.3223849272e16*beta51-0.6576652515e17*beta49;
E(18)=0.9225103806e13*beta2-0.1426879042e20*beta12+...
     0.1946984893e19*beta10-0.1928852061e18*beta8+...
     0.1287671106e17*beta6-0.5098795340e15*beta4+...
     0.1242060298e22*beta18-0.3503091710e21*beta16+...
     0.7966944617e20*beta14-0.1771151098e23*beta24+...
     0.8734376824e22*beta22-0.3613143168e22*beta20+...
     0.5439914181e23*beta30-0.4405051196e23*beta28+...
     0.3032883423e23*beta26-0.3854472450e23*beta36+...
     0.5100660489e23*beta34-0.5714954556e23*beta32+...
     0.5700973776e22*beta42-0.1302138416e23*beta40+...
     0.2452158514e23*beta38-0.1206701520e21*beta48+...
     0.5665534720e21*beta46-0.2022162608e22*beta44+...
     0.8229490461e17*beta54-0.1777569940e19*beta52+...
     0.1835996509e20*beta50-0.3340110660e11;
E(19)=0.9242171539e13*beta+0.1133042622e20*beta9-...
     0.8509234348e18*beta7+0.4073616580e17*beta5-...
     0.1039843618e16*beta3-0.4007784972e22*beta15+...
     0.7394704976e21*beta13-0.1059769345e21*beta11+...
     0.1797013988e24*beta21-0.6135417909e23*beta19+...
     0.1735943805e23*beta17-0.1619374159e25*beta27+...
     0.9163319912e24*beta25-0.4412659077e24*beta23+...
     0.3515239536e25*beta33-0.3166113687e25*beta31+...
     0.2446041365e25*beta29-0.1887832270e25*beta39+...
     0.2723207843e25*beta37-0.3345599323e25*beta35+...
     0.2219341057e24*beta45-0.5448671537e24*beta43+...
     0.1107526919e25*beta41-0.7351385027e23*beta47-...
     0.3863905006e22*beta51+0.1929992203e23*beta49-...
     0.5070804025e20*beta55+0.5541717247e21*beta53+0.2224036853e19*beta57;
E(20)=-0.1571398449e16*beta2+0.6029476552e22*beta12-...
     0.6885636856e21*beta10+0.5710998543e20*beta8-...
     0.3187354169e19*beta6+0.1051051407e18*beta4-...
     0.9088857691e24*beta18+0.2126828963e24*beta16-...
     0.4029424892e23*beta14+0.2351107291e26*beta24-...
     0.9439680560e25*beta22+0.3203092591e25*beta20-...
     0.1419941931e27*beta30+0.9072390475e26*beta28-...
     0.4988831929e26*beta26+0.2256682086e27*beta36-...
     0.2238164878e27*beta34+0.1917830887e27*beta32-...
     0.9401487535e26*beta42+0.1468326932e27*beta40-...
     0.1962852079e27*beta38+0.8928965461e25*beta48-...
     0.2344884678e26*beta46+0.5116994571e26*beta44-...
     0.1294028109e24*beta54+0.6851631967e24*beta52-...
     0.2774112770e25*beta50+0.6343779908e20*beta60-...
     0.1522507178e22*beta58+0.1755247559e23*beta56+0.4629639853e13;
E(21)=-0.1573752424e16*beta-0.3913180795e22*beta9+...
     0.2480389195e21*beta7-0.9995615941e19*beta5+...
     0.2136280851e18*beta3+0.2303798120e25*beta15-...
     0.3581839729e24*beta13+0.4333222405e23*beta11-...
     0.1762237207e27*beta21+0.5013450773e26*beta19-...
     0.1187518031e26*beta17+0.2851620683e28*beta27-...
     0.1317705507e28*beta25+0.5222607594e27*beta23-...
     0.1208117189e29*beta33+0.8605176154e28*beta31-...
     0.5322901413e28*beta29+0.1446850708e29*beta39-...
     0.1567030743e29*beta37+0.1475162830e29*beta35-...
     0.4768700964e28*beta45+0.8017064310e28*beta43-...
     0.1158580489e29*beta41+0.2420497988e28*beta47+...
     0.3710927630e27*beta51-0.1038044543e28*beta49+...
     0.2531237132e26*beta55-0.1085563330e27*beta53-...
     0.4524344789e25*beta57+0.5821122766e24*beta59+...
     0.1904555038e22*beta63-0.4799478696e23*beta61;
E(22)=0.3224202018e18*beta2-0.2824867921e25*beta12+...
     0.2746590627e24*beta10-0.1938887561e23*beta8+...
     0.9193660693e21*beta6-0.2565918500e20*beta4+...
     0.6959743445e27*beta18-0.1379340250e27*beta16+...
     0.2219142997e26*beta14-0.3035593563e29*beta24+...
     0.1019056903e29*beta22-0.2906049763e28*beta20+...
     0.3264726216e30*beta30-0.1707693621e30*beta28+...
     0.7750161862e29*beta26-0.1006244800e31*beta36+...
     0.7907641481e30*beta34-0.5436639434e30*beta32+...
     0.9301570658e30*beta42-0.1092431640e31*beta40+...
     0.1120863936e31*beta38-0.2466586080e30*beta48+...
     0.4441421380e30*beta46-0.6900090200e30*beta44+...
     0.1592319349e29*beta54-0.4726652152e29*beta52+...
     0.1172881712e30*beta50-0.1648633707e27*beta60+...
     0.9718052788e27*beta58-0.4400835872e28*beta56+...
     0.6003391325e23*beta66-0.1584895310e25*beta64+...
     0.2017357550e26*beta62-0.7880553908e15;
E(23)=0.3228195314e18*beta+0.1532454528e25*beta9-...
     0.8319759142e23*beta7+0.2863835748e22*beta5-...
     0.5201914185e20*beta3-0.1432163409e28*beta15+...
     0.1907581453e27*beta13-0.1978918945e26*beta11+...
     0.1766026271e30*beta21-0.4272154078e29*beta19+...
     0.8632271912e28*beta17-0.4773224012e31*beta27+...
     0.1849392110e31*beta25-0.6179422884e30*beta23+...
     0.3576017254e32*beta33-0.2089703498e32*beta31+...
     0.1069310783e32*beta29-0.8260566573e32*beta39+...
     0.7100898191e32*beta37-0.5373109286e32*beta35+...
     0.6014623150e32*beta45-0.7614276626e32*beta43+...
     0.8457977032e32*beta41-0.4155621797e32*beta47-...
     0.1302115359e32*beta51+0.2500249631e32*beta49-...
     0.2213362578e31*beta55+0.5823565428e31*beta53+...
     0.7049871793e30*beta57-0.1846470059e30*beta59-...
     0.6251200557e28*beta63+0.3872321712e29*beta61+...
     0.1982330332e25*beta69-0.5471231716e26*beta67+0.7292408841e27*beta65;
E(24)=-0.7843406110e20*beta2+0.1465563342e28*beta12-...
     0.1230168467e27*beta10+0.7491580780e25*beta8-...
     0.3058510962e24*beta6+0.7322669027e22*beta4-...
     0.5637136980e30*beta18+0.9616140569e29*beta16-...
     0.1333919212e29*beta14+0.3920859180e32*beta24-...
     0.1122789171e32*beta22+0.2741165562e31*beta20-...
     0.6988577241e33*beta30+0.3072289718e33*beta28-...
     0.1178513189e33*beta26+0.3786490754e34*beta36-...
     0.2445710808e34*beta34+0.1393720877e34*beta32-...
     0.6719480295e34*beta42+0.6272764307e34*beta40-...
     0.5181419931e34*beta38+0.3921205109e34*beta48-...
     0.5323232236e34*beta46+0.6364927502e34*beta44-...
     0.7019491502e33*beta54+0.1431768154e34*beta52-...
     0.2535158989e34*beta50+0.3218533082e32*beta60-...
     0.1065583643e33*beta58+0.2963173302e33*beta56-...
     0.2462835544e30*beta66+0.1599475612e31*beta64-...
     0.8010583413e31*beta62-0.1970740981e28*beta70+...
     0.2744973388e29*beta68+0.6842850629e26*beta72+0.1616097309e18;
E(25)=-0.7851575393e20*beta-0.6764208211e27*beta9+...
     0.3184043793e26*beta7-0.9477058012e24*beta5+...
     0.1481572343e23*beta3+0.9654437767e30*beta15-...
     0.1116493332e30*beta13+0.1006039000e29*beta11-...
     0.1835109345e33*beta21+0.3835073306e32*beta19-...
     0.6709497280e31*beta17+0.7840210679e34*beta27-...
     0.2598048070e34*beta25+0.7453564182e33*beta23-...
     0.9671118349e35*beta33+0.4759238292e35*beta31-...
     0.2062869609e35*beta29+0.3907123541e36*beta39-...
     0.2764846090e36*beta37+0.1737034713e36*beta35-...
     0.5438833139e36*beta45+0.5479882531e36*beta43-...
     0.4907243150e36*beta41+0.4792545583e36*beta47+...
     0.2582259927e36*beta51-0.3742246387e36*beta49+...
     0.8347096879e35*beta55-0.1568642441e36*beta53-...
     0.3865640510e35*beta57+0.1545073929e35*beta59+...
     0.1514172800e34*beta63-0.5272336249e34*beta61-...
     0.1006804963e32*beta69+0.6840612445e32*beta67-...
     0.3590051395e33*beta65+0.2464682706e28*beta75-...
     0.7394048118e29*beta73+0.1074253959e31*beta71; 
for i=1:N
% Ep coeffs, (2.7)
  Ep(i)=E(i)+(-1)^i*a(i)/(i*xi^(i)); 
  % Epg coeffs, (2.8)
  Epg(i)=E(i)+(-1)^i*ag(i)/(i*xi^(i));
end
z1=z;
if abs(z1)>=1 
  z12=z1*z1;  
  zetaf=z1^(4/3)*((3/4)*(sqrt(1-1/z12)-...
       (1/z12)*log(1+sqrt(1-1/z12))-log(z1)/z12))^(2/3);
else 
  acosz=acos(z1);
  zetaf=-((3/4)*(acosz-z1*sqrt(1-z1*z1)))^(2/3);
end
factapA=(zetaf/z2m1)^(1/4);
factapB=(1/nu^(1/3))*(zetaf)^(-1/4)*(z2m1)^(-1/4);
coefsum1=0;
coefsum2=Epg(1)/nu;
coefsum3=0;
coefsum4=Ep(1)/nu;
for j=1:m
  coefsum1=coefsum1+Epg(2*j)/nu^(2*j);
  coefsum2=coefsum2+Epg(2*j+1)/nu^(2*j+1);
  coefsum3=coefsum3+Ep(2*j)/nu^(2*j);
  coefsum4=coefsum4+Ep(2*j+1)/nu^(2*j+1);
end   
mathcalAapprox0=exp(coefsum1)*cosh(coefsum2);
mathcalBapprox0=exp(coefsum3)*sinh(coefsum4);
Acoef=factapA*mathcalAapprox0;
Bcoef=factapB*mathcalBapprox0;  
end   
    
function Uaz=asimpn(aa,w)
u=-2*aa;
z=w/sqrt(2*u);
m=8;
E1(1)=-0.41666666666666666667e-1;
E1(2)= 0.;
E1(3)= 0.97222222222222222222e-2;
E1(4)= 0.;
E1(5)= -0.12301587301587301587e-1;
E1(6)= 0.;
E1(7)= 0.37797619047619047619e-1;
E1(8)= 0.;
E1(9)= -.21506734006734006734;
E1(10)= 0.;
E1(11)= 1.9625888000888000888;
E1(12)= 0.;
E1(13)= -26.253205128205128205;
E1(14)= 0.;
E1(15)= 484.14313316993464052;
E1(16)= 0.;
E1(17)= -11773.083765377496028;
E1(18)= 0.;
E1(19)= 365017.05485247208931;
E1(20)= 0.;
E1(21)= -14053914.866545893720;
E1(22)= 0.;
E1(23)= 657869309.17583645220;
E1(24)= 0.;
E1(25)= -36794167237.101666667;
coefsum5=E1(1)/u;
for j=1:m
  coefsum5=coefsum5+E1(2*j+1)/u^(2*j+1);   
end
[Acoef,Bcoef]=ABcomplecoef(u,z);
if abs(z)>1 
  z2=z*z;  
  zetaf=z^(4/3)*((3/4)*(sqrt(1-1/z2)-...
        (1/z2)*log(1+sqrt(1-1/z2))-log(z)/z2))^(2/3);
else
  zetaf=-((3/4)*(acos(z)-z*sqrt(1-z*z)))^(2/3);
end
factorUneg=sqrt(pi)*2^(3/4-u/4)*u^(u/4-1/12);
a0=airy(u^(2/3)*zetaf);
a0p=airy(1,u^(2/3)*zetaf); 
wm0=a0*Acoef+a0p*Bcoef; 
Uaz=factorUneg*exp(-u/4+coefsum5)*wm0;  
end
    
function [u,n]=integral(a,z)
%if real(z)==0 && imag(z)<0
%   z=1.e-200+imag(z)*1i 
%end 
phase=angle(z);
if phase>-pi/2 && phase <=pi/2
   [u,n]=parabc(a,z,0); 
elseif phase>0
   f1=-1i*exp(-1i*pi*a);
   f2=sqrt(2*pi)/gamma(a+1/2)*exp((1-2*a)/4*pi*1i);
   [u1,n1]=parabc(a,-z,0);
   [u2,n2]=parabc(-a,-1i*z,0);
   u=f1*u1+f2*u2;
   n=n1+n2;
else
   f1=1i*exp(1i*pi*a);
   f2=sqrt(2*pi)/gamma(a+1/2)*exp(-(1-2*a)/4*pi*1i);
   [u1,n1]=parabc(a,-z,0);
   [u2,n2]=parabc(-a,1i*z,0);
   u=f1*u1+f2*u2;
   n=n1+n2;
end
end
function [u,n]=parabc(a,z,m)
%Utilizar solo para real(z)>0
[u,n]=parab2(a,z,m);
if n>14
% Contorno desplazado    
    [u,n]=parab2b(a,z,m);
end   
end
function [u,n]=parab2(a,z,m)
alpha=a+1/2;
s0=(z+sqrt(z^2+4*alpha))/2;
factor=@(at,zt)exp(-zt/4*sqrt(zt*zt+4*alpha)+alpha/2)/sqrt(2*pi);
integrand=@(at,zt,w)exp(-1/2*w.*w+1i*w*alpha/s0-alpha*log(s0+1i*w));
g=@(w)integrand(a,z,w);
it=trap(g,1.e-14,-15,15);
i1=it(end);
n=length(it);
if m==0
    u=factor(a,z)*i1;
else   
    u=i1;
end    
end
function [u,n]=parab2b(a,z,m)
alpha=a+1/2;
desp=1;
s0=(z+sqrt(z^2+4*alpha))/2;
factor=@(at,zt)exp(-zt/4*sqrt(zt*zt+4*alpha)+alpha/2)/sqrt(2*pi);
integrand=@(at,zt,w)exp(-1/2*(w-desp*1i).*(w-desp*1i)+...
    1i*(w-desp*1i)*alpha/s0-alpha*log(s0+1i*(w-desp*1i)));
g=@(w)integrand(a,z,w);
it=trap(g,1.e-14,-15,15);
i1=it(end);
n=length(it);
if m==0
    u=factor(a,z)*i1;
else   
    u=i1;
end    
end
function tiv=trap(funci,eps,a,b)
h=(b-a);    
ti=0.5*h*(funci(a)+funci(b));
delta=1+eps;
n=1;con=0;
while delta>eps  && con<16 
       con=con+1;
       tiv(con)=ti;
       h=0.5*h;
       sum=0;
       for i=1:n
           xac=a+(2*i-1)*h;
           sum=sum+funci(xac);
       end
       tin=0.5*ti+h*sum;
       delta=abs(1-ti/tin);
       ti=tin;
       n=2*n;
end
end    

function u=poincaru(a,z)
i=0;erro=1;u=1;b=1;
zm=2*z^2;
while erro>1.e-14 && i<100
   i=i+1;
   b=-b*(a+2*i-0.5)*(a+2*i-1.5)/i/zm;
   u=u+b;
   erro=abs(b/u);
end    
u=exp(-z^2/4)*z^(-a-1/2)*u;
end

function Uaz=UazLG(aa,w)
N=25;
m=13;
u=2*aa;
nu=u;
z=w/sqrt(2*u);
e=exp(1);
z2=z*z;
factorU=(2*e/u)^(u/4)*2*exp(-(u+1)*pi*1i/4)/(2*u*(1+z2))^(1/4);
z2m1=z2+1;
sqz2m1=sqrt(z2m1);
xi=(1/2)*(z*sqz2m1+log(z+sqz2m1));
beta=z/sqrt(1+z2);     
%E coeffs parabolic   
beta2=beta*beta; 
beta3=beta2*beta;  beta4=beta3*beta; beta5=beta4*beta; 
beta6=beta5*beta; beta7=beta6*beta; beta8=beta7*beta; 
beta9=beta8*beta;  beta10=beta9*beta; beta11=beta10*beta; 
beta12=beta11*beta; beta13=beta12*beta; beta14=beta13*beta; 
beta15=beta14*beta;  beta16=beta15*beta; beta17=beta16*beta; 
beta18=beta17*beta; beta19=beta18*beta; beta20=beta19*beta; 
beta21=beta20*beta;  beta22=beta21*beta; beta23=beta22*beta; 
beta24=beta23*beta; beta25=beta24*beta; beta26=beta25*beta; 
beta27=beta26*beta;  beta28=beta27*beta; beta29=beta28*beta; 
beta30=beta29*beta; beta31=beta30*beta; beta32=beta31*beta; 
beta33=beta32*beta;  beta34=beta33*beta; beta35=beta34*beta; 
beta36=beta35*beta; beta37=beta36*beta; beta38=beta37*beta; 
beta39=beta38*beta;  beta40=beta39*beta; beta41=beta40*beta; 
beta42=beta41*beta; beta43=beta42*beta; beta44=beta43*beta;
beta45=beta44*beta;  beta46=beta45*beta; beta47=beta46*beta; 
beta48=beta47*beta; beta49=beta48*beta; beta50=beta49*beta; 
beta51=beta50*beta;  beta52=beta51*beta; beta53=beta52*beta; 
beta54=beta53*beta; beta55=beta54*beta; beta56=beta55*beta;
beta57=beta56*beta;  beta58=beta57*beta; beta59=beta58*beta; 
beta60=beta59*beta; beta61=beta60*beta; beta62=beta61*beta; 
beta63=beta62*beta;  beta64=beta63*beta; beta65=beta64*beta; 
beta66=beta65*beta; beta67=beta66*beta; beta68=beta67*beta;
beta69=beta68*beta;  beta70=beta69*beta; beta71=beta70*beta; 
beta72=beta71*beta; beta73=beta72*beta; beta74=beta73*beta;
beta75=beta74*beta; beta76=beta75*beta; beta77=beta76*beta; 
beta78=beta77*beta; beta79=beta78*beta; beta80=beta79*beta;
beta81=beta80*beta; 
E(1)=0.416666666666666666666666666667e-1*beta*(5.*beta2-6.);
E(2)=0.625000000000000000000000000000e-1*(beta2-1.)^2*(5.*beta2-2.);
E(3)=.959201388888888888888888888889*beta9-3.45312500000000000000000000000*beta7+...
     4.60781250000000000000000000000*beta5-2.69791666666666666666666666667*beta3+...
     .593750000000000000000000000000*beta;
E(4)=4.41406250000000000000000000000*beta12-21.1875000000000000000000000000*beta10+...
     40.9218750000000000000000000000*beta8-40.0937500000000000000000000000*beta6+...
     20.4140625000000000000000000000*beta4-4.78125000000000000000000000000*beta2+...
     .312500000000000000000000000000;
E(5)=26.9612630208333333333333333333*beta15-161.767578125000000000000000000*beta13+...
     409.318359375000000000000000000*beta11-563.725694444444444444444444444*beta9+...
     453.430385044642857142857142857*beta7-210.798046875000000000000000000*beta5+...
     51.4986979166666666666666666667*beta3-4.92968750000000000000000000000*beta;
E(6)=204.947916666666666666666666667*beta18-1475.62500000000000000000000000*beta16+...
     4618.30078125000000000000000000*beta14-8201.30468750000000000000000000*beta12+...
     9035.07421875000000000000000000*beta10-6326.01562500000000000000000000*beta8+...
     2758.26171875000000000000000000*beta6-694.804687500000000000000000000*beta4+...
     83.7070312500000000000000000000*beta2-2.54166666666666666666666666667;
E(7)=85.1157226562500000000000000000*beta+105154.019521077473958333333333*beta9-...
     43714.3787318638392857142857143*beta7+11266.3085449218750000000000000*beta5-...
     1577.05208333333333333333333333*beta3-126939.370141601562500000000000*beta15+...
     177710.752899169921875000000000*beta13-166563.022521972656250000000000*beta11+...
     1863.07129632859002976190476190*beta21-15649.7988891601562500000000000*beta19+...
     58364.3921813964843750000000000*beta17;
E(8)=-2477.23242187500000000000000000*beta2+3487255.09863281250000000000000*beta12-...
     2031372.96679687500000000000000*beta10+813921.954345703125000000000000*beta8-...
     213503.751953125000000000000000*beta6+33244.5029296875000000000000000*beta4-...
     2108672.91015625000000000000000*beta18+3582215.64404296875000000000000*beta16-...
     4210267.09570312500000000000000*beta14+19708.9660644531250000000000000*beta24-...
     189206.074218750000000000000000*beta22+819110.583984375000000000000000*beta20+...
     43.2812500000000000000000000000;
E(9)=-2501.43835449218750000000000000*beta-17415421.3852700127495659722222*beta9+...
     4632797.31045532226562500000000*beta7-781299.891906738281250000000000*beta5+...
     71993.5012003580729166666666667*beta3+109154677.896041870117187500000*beta15-...
     81954741.3416748046875000000000*beta13+44759535.8692859302867542613636*beta11-...
     37654805.4763590494791666666667*beta21+75232625.2479476928710937500000*beta19-...
     106373634.234054565429687500000*beta17+237850.700925897668909143518519*beta27-...
     2568787.56999969482421875000000*beta25+12661710.5966949462890625000000*beta23;
E(10)=111232.146972656250000000000000*beta2-1108552879.86425781250000000000*beta12+...
     421128957.611279296875000000000*beta10-113310599.031738281250000000000*beta8+...
     20335320.2656250000000000000000*beta6-2182922.41406250000000000000000*beta4+...
     3356610252.02734375000000000000*beta18-3088027191.64746093750000000000*beta16+...
     2139956710.43774414062500000000*beta14-721862621.848144531250000000000*beta24+...
     1658346147.20947265625000000000*beta22-2741050372.20468750000000000000*beta20+...
     3225059.84497070312500000000000*beta30-38700718.1396484375000000000000*beta28+...
     213974888.631591796875000000000*beta26-1263.02500000000000000000000000;
E(11)= 111920.1949310302734375*beta+3085120100.*beta9-581996200.563204084123883*beta7+...
     70157248.15055465698*beta5-...
     4611098.7679290771484375*beta3-0.6153607495e11*beta15+0.3049958938e11*beta13-...
     0.1135846460e11*beta11+0.1036337171e12*beta21-0.1129303279e12*beta19+...
     0.9493429829e11*beta17-0.1481862973e11*beta27+0.3848124070e11*beta25-...
     0.7280910459e11*beta23+48543036.19*beta33-640768077.7*beta31+3927199353.*beta29;
E(12)= -7060073.908447265625*beta2+0.3380972893e12*beta12-0.9256409331e11*beta10+...
     0.1819188569e11*beta8-2403059790.*beta6+190009696.9*beta4-0.3157292573e13*beta18+...
     0.1933847987e13*beta16-0.9232167883e12*beta14+0.3252890979e13*beta24-...
     0.4097994257e13*beta22+0.4052272383e13*beta20-0.3247740029e12*beta30+...
     0.9406798639e12*beta28-0.2004980936e13*beta26+803186730.9*beta36-...
     0.1156588892e11*beta34+0.7782501964e11*beta32+56307.60416666666666666666666;
E(13)=-7089958.780117034912109375*beta+0.1449032864e11*beta39-0.6172141195e12*beta9-...
     0.2260491267e12*beta37+0.8781396975e11*beta7+0.1656668662e13*beta35-...
     8000733749.0121088027954101562*beta5+395501096.5*beta3+0.3049866179e14*beta15-...
     0.1100992808e14*beta13+0.3034781400e13*beta11-0.1549010763e15*beta21+...
     0.1130918282e15*beta19-0.6597760377e14*beta17+0.1045736977e15*beta27-...
     0.1495568359e15*beta25+0.1701077814e15*beta23-0.7575890725e13*beta33+...
     0.2421319015e14*beta31-0.5740670331e14*beta29;
E(14)= 602266918.0216827392578125*beta2-0.1079559615e15*beta12+...
     0.2260384042e14*beta10-...
     0.3420153835e13*beta8+0.3488179126e12*beta6-0.2125041725e11*beta4+...
     0.2429602541e16*beta18-0.1092080833e16*beta16+0.3893716733e15*beta14-...
     0.7422818013e16*beta24+0.6295862491e16*beta22-0.4344611527e16*beta20+...
     0.2830991783e12*beta42-0.4756066195e13*beta40+0.3770973995e14*beta38-...
     3560017.517857142857142857142857142857143+0.3458461523e16*beta30-...
     0.5535980089e16*beta28+...
     0.7120648489e16*beta26-0.1875241489e15*beta36+0.6555489710e15*beta34-...
     0.1711273741e16*beta32;
E(15)= 604121813.9849621057510375976562*beta-0.4911442846e16*beta39+...
     0.1417053690e15*beta9+...
     0.1864177044e17*beta37-0.1584907343e14*beta7-0.5313036598e17*beta35+...
     0.1134624724e13*beta5-0.4381689568e11*beta3-0.1486188264e17*beta15+...
     0.4141617137e16*beta13-0.8891261324e15*beta11+0.1783131717e18*beta21-...
     0.9607939929e17*beta19+0.4213834451e17*beta17-0.3522923511e18*beta27+...
     0.3405329064e18*beta25-0.2714809670e18*beta23+0.1179731705e18*beta33-...
     0.2089776209e18*beta31+0.2999423116e18*beta29+0.5954671150e13*beta45-...
     0.1071840807e15*beta43+0.9141452529e15*beta41;
E(16)= -0.6648971579e11*beta2+0.3739880512e17*beta12-0.6231463745e16*beta10+...
     0.7527848719e15*beta8-0.6132689600e14*beta6+0.2974530207e13*beta4-...
     0.1743171154e19*beta18+0.6089515299e18*beta16-0.1704613412e18*beta14+...
     0.1239078696e20*beta24-0.7790655103e19*beta22+0.4061937279e19*beta20-...
     0.1671691705e20*beta30+0.1814335249e20*beta28-0.1641465045e20*beta26+...
     0.4156773081e19*beta36-0.8073305479e19*beta34+0.1279192380e20*beta32-...
     0.1357454608e18*beta42+0.5559293533e18*beta40-0.1717683753e19*beta38+...
     0.1341656582e15*beta48-0.2575980637e16*beta46+0.2351540543e17*beta44+...
     302992377.265625;
E(17)= -0.6664572055e11*beta-0.3742041297e17*beta9+0.3390526387e16*beta7-...
     0.1962895600e15*beta5+0.6094029671e13*beta3+0.7492620607e19*beta15-...
     0.1675511412e19*beta13+0.2901389241e18*beta11-0.1828583524e21*beta21+...
     0.7696804165e20*beta19-0.2666029131e20*beta17+0.8305064451e21*beta27-...
     0.5972129247e21*beta25+0.3611593011e21*beta23-0.7983138888e21*beta33+...
     0.9613615991e21*beta31-0.9733558995e21*beta29+0.1513952498e21*beta39-...
     0.3199131040e21*beta37+0.5546581845e21*beta35-0.3949329014e19*beta45+...
     0.1735812650e20*beta43-0.5779346632e20*beta41+0.6398229506e18*beta47+...
     0.3223849272e16*beta51-0.6576652515e17*beta49;
E(18)= 0.9225103806e13*beta2-0.1426879042e20*beta12+0.1946984893e19*beta10-...
     0.1928852061e18*beta8+0.1287671106e17*beta6-0.5098795340e15*beta4+...
     0.1242060298e22*beta18-0.3503091710e21*beta16+0.7966944617e20*beta14-...
     0.1771151098e23*beta24+0.8734376824e22*beta22-0.3613143168e22*beta20+...
     0.5439914181e23*beta30-0.4405051196e23*beta28+0.3032883423e23*beta26-...
     0.3854472450e23*beta36+0.5100660489e23*beta34-0.5714954556e23*beta32+...
     0.5700973776e22*beta42-0.1302138416e23*beta40+0.2452158514e23*beta38-...
     0.1206701520e21*beta48+0.5665534720e21*beta46-0.2022162608e22*beta44+...
     0.8229490461e17*beta54-0.1777569940e19*beta52+0.1835996509e20*beta50-...
     0.3340110660e11;
E(19)= 0.9242171539e13*beta+0.1133042622e20*beta9-0.8509234348e18*beta7+...
     0.4073616580e17*beta5-0.1039843618e16*beta3-0.4007784972e22*beta15+...
     0.7394704976e21*beta13-0.1059769345e21*beta11+0.1797013988e24*beta21-...
     0.6135417909e23*beta19+0.1735943805e23*beta17-0.1619374159e25*beta27+...
     0.9163319912e24*beta25-0.4412659077e24*beta23+0.3515239536e25*beta33-...
     0.3166113687e25*beta31+0.2446041365e25*beta29-0.1887832270e25*beta39+...
     0.2723207843e25*beta37-0.3345599323e25*beta35+0.2219341057e24*beta45-...
     0.5448671537e24*beta43+0.1107526919e25*beta41-0.7351385027e23*beta47-...
     0.3863905006e22*beta51+0.1929992203e23*beta49-0.5070804025e20*beta55+...
     0.5541717247e21*beta53+0.2224036853e19*beta57;
E(20)= -0.1571398449e16*beta2+0.6029476552e22*beta12-0.6885636856e21*beta10+...
     0.5710998543e20*beta8-0.3187354169e19*beta6+0.1051051407e18*beta4-...
     0.9088857691e24*beta18+0.2126828963e24*beta16-0.4029424892e23*beta14+...
     0.2351107291e26*beta24-0.9439680560e25*beta22+0.3203092591e25*beta20-...
     0.1419941931e27*beta30+0.9072390475e26*beta28-0.4988831929e26*beta26+...
     0.2256682086e27*beta36-0.2238164878e27*beta34+0.1917830887e27*beta32-...
     0.9401487535e26*beta42+0.1468326932e27*beta40-0.1962852079e27*beta38+...
     0.8928965461e25*beta48-0.2344884678e26*beta46+0.5116994571e26*beta44-...
     0.1294028109e24*beta54+0.6851631967e24*beta52-0.2774112770e25*beta50+...
     0.6343779908e20*beta60-0.1522507178e22*beta58+0.1755247559e23*beta56+...
     0.4629639853e13;
E(21)= -0.1573752424e16*beta-0.3913180795e22*beta9+0.2480389195e21*beta7-...
     0.9995615941e19*beta5+0.2136280851e18*beta3+0.2303798120e25*beta15-...
     0.3581839729e24*beta13+0.4333222405e23*beta11-0.1762237207e27*beta21+...
     0.5013450773e26*beta19-0.1187518031e26*beta17+0.2851620683e28*beta27-...
     0.1317705507e28*beta25+0.5222607594e27*beta23-0.1208117189e29*beta33+...
     0.8605176154e28*beta31-0.5322901413e28*beta29+0.1446850708e29*beta39-...
     0.1567030743e29*beta37+0.1475162830e29*beta35-0.4768700964e28*beta45+...
     0.8017064310e28*beta43-0.1158580489e29*beta41+0.2420497988e28*beta47+...
     0.3710927630e27*beta51-0.1038044543e28*beta49+0.2531237132e26*beta55-...
     0.1085563330e27*beta53-0.4524344789e25*beta57+0.5821122766e24*beta59+...
     0.1904555038e22*beta63-0.4799478696e23*beta61;
E(22)= 0.3224202018e18*beta2-0.2824867921e25*beta12+0.2746590627e24*beta10-...
     0.1938887561e23*beta8+0.9193660693e21*beta6-0.2565918500e20*beta4+...
     0.6959743445e27*beta18-0.1379340250e27*beta16+0.2219142997e26*beta14-...
     0.3035593563e29*beta24+0.1019056903e29*beta22-0.2906049763e28*beta20+...
     0.3264726216e30*beta30-0.1707693621e30*beta28+0.7750161862e29*beta26-...
     0.1006244800e31*beta36+0.7907641481e30*beta34-0.5436639434e30*beta32+...
     0.9301570658e30*beta42-0.1092431640e31*beta40+0.1120863936e31*beta38-...
     0.2466586080e30*beta48+0.4441421380e30*beta46-0.6900090200e30*beta44+...
     0.1592319349e29*beta54-0.4726652152e29*beta52+0.1172881712e30*beta50-...
     0.1648633707e27*beta60+0.9718052788e27*beta58-0.4400835872e28*beta56+...
     0.6003391325e23*beta66-0.1584895310e25*beta64+0.2017357550e26*beta62-...
     0.7880553908e15;
E(23)= 0.3228195314e18*beta+0.1532454528e25*beta9-0.8319759142e23*beta7+...
     0.2863835748e22*beta5-0.5201914185e20*beta3-0.1432163409e28*beta15+...
     0.1907581453e27*beta13-0.1978918945e26*beta11+0.1766026271e30*beta21-...
     0.4272154078e29*beta19+0.8632271912e28*beta17-0.4773224012e31*beta27+...
     0.1849392110e31*beta25-0.6179422884e30*beta23+0.3576017254e32*beta33-...
     0.2089703498e32*beta31+0.1069310783e32*beta29-0.8260566573e32*beta39+...
     0.7100898191e32*beta37-0.5373109286e32*beta35+0.6014623150e32*beta45-...
     0.7614276626e32*beta43+0.8457977032e32*beta41-0.4155621797e32*beta47-...
     0.1302115359e32*beta51+0.2500249631e32*beta49-0.2213362578e31*beta55+...
     0.5823565428e31*beta53+0.7049871793e30*beta57-0.1846470059e30*beta59-...
     0.6251200557e28*beta63+0.3872321712e29*beta61+0.1982330332e25*beta69-...
     0.5471231716e26*beta67+0.7292408841e27*beta65;
E(24)= -0.7843406110e20*beta2+0.1465563342e28*beta12-0.1230168467e27*beta10+...
     0.7491580780e25*beta8-0.3058510962e24*beta6+0.7322669027e22*beta4-...
     0.5637136980e30*beta18+0.9616140569e29*beta16-0.1333919212e29*beta14+...
     0.3920859180e32*beta24-0.1122789171e32*beta22+0.2741165562e31*beta20-...
     0.6988577241e33*beta30+0.3072289718e33*beta28-0.1178513189e33*beta26+...
     0.3786490754e34*beta36-0.2445710808e34*beta34+0.1393720877e34*beta32-...
     0.6719480295e34*beta42+0.6272764307e34*beta40-0.5181419931e34*beta38+...
     0.3921205109e34*beta48-0.5323232236e34*beta46+0.6364927502e34*beta44-...
     0.7019491502e33*beta54+0.1431768154e34*beta52-0.2535158989e34*beta50+...
     0.3218533082e32*beta60-0.1065583643e33*beta58+0.2963173302e33*beta56-...
     0.2462835544e30*beta66+0.1599475612e31*beta64-0.8010583413e31*beta62-...
     0.1970740981e28*beta70+0.2744973388e29*beta68+0.6842850629e26*beta72+...
     0.1616097309e18;
E(25)= -0.7851575393e20*beta-0.6764208211e27*beta9+0.3184043793e26*beta7-...
     0.9477058012e24*beta5+0.1481572343e23*beta3+0.9654437767e30*beta15-...
     0.1116493332e30*beta13+0.1006039000e29*beta11-0.1835109345e33*beta21+...
     0.3835073306e32*beta19-0.6709497280e31*beta17+0.7840210679e34*beta27-...
     0.2598048070e34*beta25+0.7453564182e33*beta23-0.9671118349e35*beta33+...
     0.4759238292e35*beta31-0.2062869609e35*beta29+0.3907123541e36*beta39-...
     0.2764846090e36*beta37+0.1737034713e36*beta35-0.5438833139e36*beta45+...
     0.5479882531e36*beta43-0.4907243150e36*beta41+0.4792545583e36*beta47+...
     0.2582259927e36*beta51-0.3742246387e36*beta49+0.8347096879e35*beta55-...
     0.1568642441e36*beta53-0.3865640510e35*beta57+0.1545073929e35*beta59+...
     0.1514172800e34*beta63-0.5272336249e34*beta61-0.1006804963e32*beta69+...
     0.6840612445e32*beta67-0.3590051395e33*beta65+0.2464682706e28*beta75-...
     0.7394048118e29*beta73+0.1074253959e31*beta71;
E(26)=22322099777465932693523.38007242977619171*beta2-...
      39298774127818498965.00961538461538461538+...
      92468917740877498593564250674.08502889940*beta78-...
      2885030233515377956119204621031.452901661*beta76+...
      43646544324440057951137586979956.13631792*beta74-...
      426518436764929662057951318497560.7412867*beta72+...
      3025855029887412054864269907633890.470136*beta70-...
      16606013363526657598133268197652022.40210*beta68+...
      73357810388851909623999807907560075.79474*beta66-...
      267992688164136332177677298361776410.8519*beta64+...
      825493910254533283059724414663531874.9566*beta62-...
      2175131451511499830922231900656637719.363*beta60+...
      4957000754933759616675482432964410686.498*beta58-...
      9854167734625901600057296576515660165.771*beta56+...
      17202161335667914583427779969366755940.65*beta54-...
      26507508155070319274139279084425872829.72*beta52+...
      36201475619055242802473455861557193140.39*beta50-...
      43951819996419318991476436323678210392.94*beta48+...
      47541752798832801928069157254665182793.80*beta46-...
      45882789442559332635070333734738242014.17*beta44+...
      39539446410241861600374406057839379738.27*beta42-...
      30427382677220887686038792445881589726.44*beta40+...
      20898851791124371594578377223799089415.49*beta38-...
      12796623202256319873681391555518411211.91*beta36+...
      6972423137139191032092361930273881330.245*beta34-...
      3371903846216193980177102249560221578.256*beta32+...
      1442487254679439839121114313568366002.706*beta30-...
      543555872116786815357077833496717570.6121*beta28+...
      179458854246188096790180248867970499.8870*beta26-...
      51572872749894721479335652434184128.51737*beta24+...
      12796534518771428632401397396862636.63065*beta22-...
      2714048067217525246665753976483343.412545*beta20+...
      485907263212114250555108092966294.9610287*beta18-...
      72279873848851372722255826026246.67570576*beta16+...
      8752829410622619959043010888180.009432565*beta14-...
      2415689247354110369273360.804749131202698*beta4-...
      839950417118473449239884779671.9416753203*beta12+...
      61571422008025885368472550235.66124090925*beta10-...
      3271396249932596860455307769.073323719203*beta8+...
      116287941881732442880516830.0503392145038*beta6;
E(27)=22341929194264871631768.73582063350295357*beta+...
      3607846221129385822282111269492.631810798*beta81-...
      116894217564592100641940405131561.2706699*beta79+...
      1838584992197464738933920687431269.911109*beta77-...
      18702220191045546034112689419505553.09517*beta75+...
      138288948692747287918038281688026214.6782*beta73-...
      792111506146256105434472003141146110.4975*beta71+...
      3657504174215126979096032863421389250.480*beta69-...
      13988043247221331474743631242422557703.92*beta67+...
      45182235025884396079186221291093845921.53*beta65-...
      125064602911670090841241080663587386254.9*beta63+...
      299981572939363938575801602174060535968.6*beta61-...
      628950424570490049714552386422801237997.7*beta59+...
      1160550828897562952731620035794032134664.*beta57-...
      1894856665397542961015753771395967091608.*beta55+...
      2749090014427937236486956172513060991444.*beta53-...
      3555674836551536016150841566557779358793.*beta51+...
      4109996180073363138564266546528079845231.*beta49-...
      4253067352507156077681009522698395655896.*beta47+...
      3944383938330520747570514148755237134009.*beta45-...
      3280090159668224387585047987329991163929.*beta43+...
      2445599668806023716692688470025235425581.*beta41-...
      521591200223271396321265696480526400323.4*beta35-...
      1633781172547342780073362519969900104649.*beta39+...
      976732075642300212916938275036167035531.1*beta37+...
      248184239276329782364226016386618225970.7*beta33-...
      104883880659718482918034507553911233204.0*beta31+...
      39208377104341692353926723035889864900.61*beta29-...
      12900767918663517313171452488544156196.27*beta27+...
      3713282093982274140905603604096191487.728*beta25-...
      927997959150026001354118539657168871.8742*beta23+...
      199516719625816362763866199451893487.2176*beta21-...
      36483892452185163484303421311530590.21447*beta19+...
      5593879510205212351447071577378183.244081*beta17-...
      706204498226427929823612776151270.8486079*beta15+...
      71697715622299387880907855833353.78718568*beta13-...
      5671857690218961786425376826064.697947120*beta11+...
      334585386821000292845623995070.4646746019*beta9-...
      13797274292665364322395913205.61844037822*beta7+...
      358804911717051855119152484.6694361620520*beta5-...
      4879850329627454450910281.860133859547811*beta3;     
Em1(1)=0.416666666666666666666666666667e-1;
Em1(2)=0.;
Em1(3)=-0.972222222222222222222222222222e-2;
Em1(4)=0.;
Em1(5)=0.123015873015873015873015873016e-1;
Em1(6)=0.;
Em1(7)=-0.377976190476190476190476190476e-1;
Em1(8)=0.;
Em1(9)=.215067340067340067340067340067;
Em1(10)=0.;
Em1(11)=-1.96258880008880008880008880009;
Em1(12)=0.;
Em1(13)=26.2532051282051282051282051282;
Em1(14)=0.;
Em1(15)=-484.143133169934640522875816993;
Em1(16)=0.;
Em1(17)=11773.0837653774960276508264124;
Em1(18)=0.;
Em1(19)=-365017.054852472089314194577352;
Em1(20)=0.;
Em1(21)=14053914.8665458937198067632850;
Em1(22)=0.;
Em1(23)=-657869309.175836452195147847322;
Em1(24)=0.;
Em1(25)=36794167237.1016666666666666667;
Em1(26)=0.;
Em1(27)=-2423218601218.954177309493401447424435930;
Em1(28)=0.;
coefsum1=0;
coefsum2=Em1(1)/nu;
coefsum3=E(1)/nu;
for j=1:m
  coefsum1=coefsum1+E(2*j)/nu^(2*j);
  coefsum2=coefsum2+Em1(2*j+1)/nu^(2*j+1);
  coefsum3=coefsum3+E(2*j+1)/nu^(2*j+1);
end   
ji=1i*u*xi+(1/4)*(u+1)*pi-1i*coefsum3;   
Uaz=factorU*exp(coefsum1+coefsum2)*cos(ji);  
end  

function Uazp=UazLGp(aa,w)
N=25;
m=10;
u=2*aa;
nu=u;
z=w/sqrt(2*u);
e=exp(1);
z2=z*z;
factorU=-(2*e/u)^(u/4)*exp(-(u-1)*pi*1i/4)*(2*u*(1+z2))^(1/4);
z2m1=z2+1;
sqz2m1=sqrt(z2m1);
xi=(1/2)*(z*sqz2m1+log(z+sqz2m1));
beta=z/sqrt(1+z2);     
%E coeffs parabolic   
beta2=beta*beta; 
beta3=beta2*beta;  beta4=beta3*beta; beta5=beta4*beta; 
beta6=beta5*beta; beta7=beta6*beta; beta8=beta7*beta; 
beta9=beta8*beta;  beta10=beta9*beta; beta11=beta10*beta; 
beta12=beta11*beta; beta13=beta12*beta; beta14=beta13*beta; 
beta15=beta14*beta;  beta16=beta15*beta; beta17=beta16*beta; 
beta18=beta17*beta; beta19=beta18*beta; beta20=beta19*beta; 
beta21=beta20*beta;  beta22=beta21*beta; beta23=beta22*beta; 
beta24=beta23*beta; beta25=beta24*beta; beta26=beta25*beta; 
beta27=beta26*beta;  beta28=beta27*beta; beta29=beta28*beta; 
beta30=beta29*beta; beta31=beta30*beta; beta32=beta31*beta; 
beta33=beta32*beta;  beta34=beta33*beta; beta35=beta34*beta; 
beta36=beta35*beta; beta37=beta36*beta; beta38=beta37*beta; 
beta39=beta38*beta;  beta40=beta39*beta; beta41=beta40*beta; 
beta42=beta41*beta; beta43=beta42*beta; beta44=beta43*beta;
beta45=beta44*beta;  beta46=beta45*beta; beta47=beta46*beta; 
beta48=beta47*beta; beta49=beta48*beta; beta50=beta49*beta; 
beta51=beta50*beta;  beta52=beta51*beta; beta53=beta52*beta; 
beta54=beta53*beta; beta55=beta54*beta; beta56=beta55*beta;
beta57=beta56*beta;  beta58=beta57*beta; beta59=beta58*beta; 
beta60=beta59*beta; beta61=beta60*beta; beta62=beta61*beta; 
beta63=beta62*beta;  beta64=beta63*beta; beta65=beta64*beta; 
beta66=beta65*beta; beta67=beta66*beta; beta68=beta67*beta;
beta69=beta68*beta;  beta70=beta69*beta; beta71=beta70*beta; 
beta72=beta71*beta; beta73=beta72*beta; beta74=beta73*beta;
beta75=beta74*beta; beta76=beta75*beta; beta77=beta76*beta; 
beta78=beta77*beta; beta79=beta78*beta; beta80=beta79*beta;
beta81=beta80*beta; 
E(1)=.4166666666666666666666666666666666666667e-1*beta*(7.*beta2-6.);
E(2)=.625e-1*(-1.*beta2+1.)^2*...
     (-7.*beta2+2.);
E(3)=1.269965277777777777777777777777777777778*beta9-...
     4.484375*beta7+5.8296875*beta5-3.28125*beta3+...
     .65625*beta;
E(4)=-5.5234375*beta12+26.25*beta10-50.078125*beta8+...
     48.28125*beta6-24.0234375*beta4+5.40625*beta2-.3125;
E(5)=32.24420572916666666666666666666666666667*beta15-...
     192.322265625*beta13+483.220703125*beta11-...
     659.8133680555555555555555555555555555556*beta9+...
     524.9407087053571428571428571428571428571*beta7-...
     240.438671875*beta5+...
     57.42317708333333333333333333333333333333*beta3-...
     5.2421875*beta;
E(6)=-236.9427083333333333333333333333333333333*beta18+...
     1699.359375*beta16-5294.68359375*beta14+...
     9352.888020833333333333333333333333333333*beta12-...
     10238.31640625*beta10+...
     7111.8125*beta8-3068.858072916666666666666666666666666667*beta6+...
     761.7734375*beta4-89.57421875*beta2+...
     2.541666666666666666666666666666666666667;
E(7)=88.04833984375*beta+...
     2100.936167399088541666666666666666666667*beta21-...
     17599.49749755859375*beta19+...
     65432.061431884765625*beta17-...
     141805.2973388671875*beta15+...
     197700.547393798828125*beta13-...
     184386.70062255859375*beta11+...
     115706.4780375162760416666666666666666667*beta9-...
     47734.42560686383928571428571428571428571*beta7+...
     12176.496142578125*beta5-...
     1678.684244791666666666666666666666666667*beta3;
E(8)=2576.529296875*beta2-43.28125-...
     21819.869873046875*beta24+209044.25390625*beta22-...
     902939.912109375*beta20+2318540.8203125*beta18-...
     3927286.41845703125*beta16+4600344.419921875*beta14-...
     876461.053466796875*beta8+228166.435546875*beta6-...
     35155.3056640625*beta4-3795324.1279296875*beta12+...
     2200357.509765625*beta10;
E(9)=-2551.0770263671875*beta+...
     259707.8842164498788339120370370370370370*beta27-...
     2800433.18358612060546875*beta25+....
     13779585.3557586669921875*beta23-...
     40900456.46592203776041666666666666666667*beta21+...
     81541391.58374786376953125*beta19-...
     115013188.0566253662109375*beta17+...
     117691367.9880930582682291666666666666667*beta15-...
     88078247.51617431640625*beta13+...
     47919578.37844051014293323863636363636364*beta11-...
     18558255.15885670979817708333333333333333*beta9+...
     4907983.373748779296875*beta7-...
     821327.76104736328125*beta5+...
     74844.87030029296875*beta3;
E(10)=-114026.59326171875*beta2+...
     1263.025-3484228.556005859375*beta30+...
     41758374.984375*beta28-230565010.004150390625*beta26+...
     776664028.78955078125*beta24-1781285213.02880859375*beta22+...
     2938821466.096484375*beta20-3591334921.0234375*beta18+...
     3296192768.9560546875*beta16-2278026449.555419921875*beta14+...
     119229368.80517578125*beta8-21270934.861328125*beta6+...
     2265070.125*beta4+1176339931.443359375*beta12-...
     445191488.602587890625*beta10;
E(11)= 113317.3020172119140625000000000000000000*beta+...
      52008453.28136689012700861150568181818182*beta33-...
      685810372.0266585350036621093750000000000*beta31+...
      4198610709.311280965805053710937500000000*beta29-...
      15823698765.46678935156928168402777777778*beta27+...
      41037171290.79627885818481445312500000000*beta25-...
      77532744670.80077075958251953125000000000*beta23+...
      110180266407.6873036112104143415178571429*beta21-...
      119849207435.4893531799316406250000000000*beta19+...
      100547261665.3961942195892333984375000000*beta17-...
      65024349876.61196660995483398437500000000*beta15+...
      32142706281.18762894777151254507211538462*beta13-...
      11932871428.59873797676780007102272727273*beta11+...
      3228905838.212204297383626302083333333333*beta9-...
      606265736.4340340750558035714285714285714*beta7+...
      72637886.51787185668945312500000000000000*beta5-...
      4733566.226425170898437500000000000000000*beta3;    
E(12)=7180769.704345703125*beta2-...
      56307.60416666666666666666666666666666667-...
      854782802.1127522786458333333333333333333*beta36+...
      12298419664.755615234375*beta34-...
      82678520970.38763427734375*beta32+...
      344688066937.4407958984375*beta30-...
      997291683501.394500732421875*beta28+...
      2123167556432.9923095703125*beta26-...
      3440239797749.174886067708333333333333333*beta24+...
      4327915318191.53125*beta22-...
      4272936671189.132232666015625*beta20+...
      3323389904234.229736328125*beta18-...
      2031548173833.48211669921875*beta16+...
      967656545915.8128662109375*beta14-...
      18885511621.7779541015625*beta8+...
      2482726288.028889973958333333333333333333*beta6-...
      195060098.530487060546875*beta4-...
      353436052229.049102783203125*beta12+...
      96460591868.1500244140625*beta10;
E(13)=-7150304.668636322021484375*beta+...
      15336823326.90033064667995159442608173077*beta39-...
      239082816003.816647350788116455078125*beta37+...
      1750845694346.127291381359100341796875*beta35-...
      7999968354528.1667029857635498046875*beta33+...
      25545913154969.04807016253471374511718750*beta31-...
      60508389390217.00359064340591430664062500*beta29+...
      110109086912451.9836153189341227213541667*beta27-...
      157294389736614.9995148181915283203125000*beta25+...
      178685394337400.5427889525890350341796875*beta23-...
      162487580000223.9463862776756286621093750*beta21+...
      118448524752731.2252773642539978027343750*beta19-...
      68983463316649.46876025199890136718750000*beta17+...
      31825643618318.95424726605415344238281250*beta15-...
      11463046833974.65373431260769183819110577*beta13+...
      3151339841230.01484215259552001953125*beta11-...
      638898561688.2806084156036376953125*beta9+...
      90546789365.553092479705810546875*beta7-...
      8208809103.55438327789306640625*beta5+...
      403045194.4626140594482421875*beta3;
E(14)=-609734983.0684051513671875*beta2+...
      3560017.517857142857142857142857142857143-...
      298269678122.43463134765625*beta42+...
      5007853374369.2958984375*beta40-...
      39680149545167.85369873046875*beta38+...
      197185010430987.578125*beta36-688806716107446.08184814453125*beta34+...
      1796648756644931.8271484375*beta32-...
      3627862690273727.5915374755859375*beta30+...
      5801703411755298.642643519810267857142857*beta28-...
      7454833364453890.0251007080078125*beta26+...
      7762528084106295.78643798828125*beta24-...
      6575928719778436.6484222412109375*beta22+...
      4531717968327738.291717529296875*beta20-...
      2530394714063999.4660186767578125*beta18+...
      1135441712383022.5579833984375*beta16-...
      404042350534266.4964839390345982142857143*beta14+...
      3520304144883.75030517578125*beta8-...
      357602116392.1408843994140625*beta6+...
      21672434212.212677001953125*beta4+...
      111770859567954.699920654296875*beta12-...
      23340450443280.3536834716796875*beta10;
E(15)=607855792.94262349605560302734375*beta+...
      958356255111135.1018011909909546375274658*beta41+...
      6249501262536.679016940326740344365437826*beta45-...
      112431209114685.3110154038295149803161621*beta43-...
      5145893076486876.377218589807550112406413*beta39+...
      19519187652819231.61562561942264437675476*beta37-...
      55593163449900258.08552828822284936904907*beta35+...
      123351550761341030.0949812511292596658071*beta33-...
      218333313862019501.5616176389157772064209*beta31+...
      313104767290751678.1258581154979765415192*beta29-...
      367414131738959010.0871272187473045455085*beta27+...
      354794335109042350.6539747070334851741791*beta25-...
      282540272711540617.6403168644756078720093*beta23+...
      185352705424714973.0860073875325421492259*beta21-...
      99738356853573407.28687856998294591903687*beta19+...
      43677293266315596.31543976252022034981672*beta17-...
      15378442688727735.80368151416381200154622*beta15+...
      4277214227266927.366012252867221832275391*beta13-...
      916154058291610.5018962025642395019531250*beta11+...
      145620268970054.4445881595214207967122396*beta9-...
      16233621691865.06877887248992919921875000*beta7+...
      1157353215663.049840450286865234375000000*beta5-...
      44448361885.89484333992004394531250000000*beta3;
 E(16)=67116670921.13497161865234375*beta2-...
      302992377.265625-140340850112184.600614070892333984375*beta48+...
      2693291589505830.1063385009765625*beta46-...
      24574233549312331.00957489013671875*beta44+...
      141783971462339727.9707183837890625*beta42-...
      580339392414776428.853130340576171875*beta40+...
      1792054173239815473.2974090576171875*beta38-...
      4334039780626038506.79990386962890625*beta36+...
      8411971891225710564.108489990234375*beta34-...
      13318981949796534398.51886844635009765625*beta32+...
      17392268971703726020.36617279052734375000*beta30-...
      18860593631523121464.41669082641601562500*beta28+...
      17048106186274195704.88733673095703125000*beta26-...
      12856245606610423290.31815147399902343750*beta24+...
      8074546022243605905.13185882568359375*beta22-...
      4204910764427060922.120418548583984375*beta20+...
      1802121102988981029.55515289306640625*beta18-...
      628601465941293328.9003500938415527343750*beta16+...
      175662388831696447.23101043701171875*beta14-...
      770342519256535.2014026641845703125*beta8+...
      62545609417229.01369476318359375*beta6-...
      3020512928856.157527923583984375*beta4-...
      38464409721041769.822116851806640625*beta12+...
      6394326509227541.18122100830078125*beta10;
E(17)=-66959195936.8193696439266204833984375*beta+...
      3362502817065396.197634106845476244594537*beta51-...
      68566934712452667.37615954817738384008408*beta49+...
      666779432675828220.7316576088778674602509*beta47-...
      60141377813048793149.25871464563533663750*beta41-...
      4113845845724662376.261637754531370268928*beta45+...
      18072518011671764298.58728199847973883152*beta43+...
      157460676900389516179.7012165680838127931*beta39-...
      332538616652204729846.4463971946388483047*beta37+...
      576194260029864447344.5206501224976299064*beta35-...
      828765946730829317579.0247836099782337745*beta33+...
      997329390283680177816.4134232825599610806*beta31-...
      1009004923633863778535.444970864802598953*beta29+...
      860215374404348667870.8271760805596218065*beta27-...
      618023110861262294873.6492062411271035671*beta25+...
      373378604203889031827.8812244650907814503*beta23-...
      188841799081739720233.3550833251682065782*beta21+...
      79391908413467269751.99189093605137283080*beta19-...
      27463309479590571845.10042510863037451225*beta17+...
      7706733157133978389.207740300955871740977*beta15-...
      1720445980329262425.753305824473500251770*beta13+...
      297330944313859308.1674050036817789077759*beta11-...
      38258685490202959.11105625041657023959690*beta9+...
      3456740767869734.517078316637447902134487*beta7-...
      199422170433136.4478127062320709228515625*beta5+...
      6162905951198.388309304912885030110677083*beta3;
E(18)=-9293617853202.3012790679931640625*beta2+...
      33401106603.34722222222222222222222222222-...
      85617046766796351.04885493384467230902778*beta54+...
      1848654574082262696.572319030761718750000*beta52-...
      19086876082544509728.74276447296142578125*beta50+...
      125397325695617122094.8256015777587890625*beta48-...
      588498627051625730645.8665275573730468750*beta46+...
      2099551933657766033527.840805053710937500*beta44-...
      5916358396774837281303.591995239257812500*beta42+...
      13506575213705729028622.34756469726562500*beta40-...
      25421769787901980259399.60403442382812500*beta38+...
      39937083987379796406511.05982886420355903*beta36-...
      52817188575377440210631.12785339355468750*beta34+...
      59139871792627412305499.90011215209960938*beta32-...
      56254500695581990852462.51351038614908854*beta30+...
      45518702134163444853848.01673889160156250*beta28-...
      31314173327844583453131.40443801879882812*beta26+...
      18270719440710367541407.27110544840494792*beta24-...
      9001401075606545162856.784234046936035156*beta22+...
      3719618886004418637467.504844665527343750*beta20-...
      1277143821052979326994.751275910271538628*beta18+...
      359725030319848330703.8574314117431640625*beta16-...
      81687774351682334089.91096496582031250000*beta14+...
      196566467119324212.3674392700195312500000*beta8-...
      13084434198604740.48991839090983072916667*beta6+...
      516205093578891.9429092407226562500000000*beta4+...
      14605061196577465726.60441080729166666667*beta12-...
      1988874339881622275.320682525634765625000*beta10;
E(19)=9276428434218.907305460423231124877929688*beta+...
      2308636492724100541.890058265131524980493*beta57-...
      52619763269742458834.48539450008684070781*beta55+...
      574868191590654925361.0011648592808342073*beta53-...
      4006775756126114259703.209635624880320393*beta51+...
      20006036585345975246317.94103449588874355*beta49-...
      76173363557969740658453.02440251884399913*beta47+...
      1146079661822070469816809.927614102714870*beta41+...
      229867335012860006787884.8581572297873208*beta45-...
      564095998602735239040620.2868075355654582*beta43-...
      1952584634822877482292958.951479389725137*beta39+...
      2815138254115950017476543.708031920010399*beta37-...
      3456609961757988574785452.560139299597358*beta35+...
      3629712041323775969462080.166739237633671*beta33-...
      3267125288143888350230089.045959138631588*beta31+...
      2522341733627045149995517.206636425762554*beta29-...
      1668645500961392026679222.308213734611248*beta27+...
      943449959578610820785599.2030878792401927*beta25-...
      453924523212708466623678.5360773664506269*beta23+...
      184677833131839612880662.8072085253988917*beta21-...
      62985939151820570914457.73114855838158339*beta19+...
      17799951210013394739913.26772934511245694*beta17-...
      4104002295327900091734.936368837580084801*beta15+...
      756075886511411674958.8792787549318745732*beta13-...
      108167746815633998314.9653722706081515009*beta11+...
      11541048028995854409.28399417782202363014*beta9-...
      864624661007707539.4819322582334280014038*beta7+...
      41267493270928222.30279392767697572708130*beta5-...
      1049324053732998.882756045709053675333659*beta3;
E(20)=1580840686648654.20743846893310546875*beta2-...
      4629639852969.0625-...
      65719426799931458325.03380839824676513672*beta60+...
      1576803911145814299505.147584915161132812*beta58-...
      18172879077818987901607.55765604972839355*beta56+...
      133933739340220269486828.4081797599792480*beta54-...
      708915805279809507733169.0417500734329224*beta52+...
      2869273694447401587347117.180472850799561*beta50-...
      9231845406998108065816526.856808662414551*beta48+...
      24234830619283503422576269.87678527832031*beta46-...
      52863439221722822166222154.39811825752258*beta44+...
      97084290608501078653787187.89760589599609*beta42-...
      151557021278708523290107700.5855255126953*beta40+...
      202502143144702207516572959.7098159790039*beta38-...
      232695360782704977647117204.0837764739990*beta36+...
      230658641569585910038781382.9757118225098*beta34-...
      197529295978213408463337991.1753797531128*beta32+...
      146155948824667548344700849.2866115570068*beta30-...
      93319202729196421502633394.22303140163422*beta28+...
      51277544364652894133545650.16170501708984*beta26-...
      24146374178310379284463359.71566557884216*beta24+...
      9686247035637516610733613.357427120208740*beta22-...
      3283587599767712451607200.911762356758118*beta20+...
      930731472888761619809870.3632330894470215*beta18-...
      217535296838609853648554.3557262420654297*beta16+...
      41158211852853356650908.75563621520996094*beta14-...
      58020561123994439855.53296232223510742188*beta8+...
      3230011010323018011.398756980895996093750*beta6-...
      106176392595675535.0211446285247802734375*beta4-...
      6149324012322001958844.431884288787841797*beta12+...
      701005936967006015583.2605350494384765625*beta10;
E(21)=-1578473532420105.060027086175978183746338*beta+...
      1969520336442318479491.838033292096901682*beta63-...
      49618753250337898310105.54510684959222999*beta61+...
      601642499664523735142046.5403436249498554*beta59-...
      4674790888170365634353084.505666549677699*beta57+...
      26146192851629296617745841.18687176870071*beta55-...
      112096970594135809857698234.7249083092438*beta53+...
      383069653450171134745380346.0982717723606*beta51-...
      1071175754594414467600783007.060189706262*beta49+...
      2496843220571552081146508336.427222399047*beta47-...
      11936714886589840420500331575.10588443754*beta41-...
      4917224994459192150376405320.000824096354*beta45+...
      8263417039439293014111278339.769774261958*beta43+...
      14899978106675307815905790326.58419601853*beta39-...
      16129858889925840529790554165.42571088664*beta37+...
      15176466566811294455239693514.50681959162*beta35-...
      12422311061605248290845863959.70318414898*beta33+...
      8842985036243866759110500215.643834000164*beta31-...
      5466563013176963225313510163.016490919704*beta29+...
      2926597363354763821207948081.301122948607*beta27-...
      1351357550637684762465354047.846960887324*beta25+...
      535169885436364445227012470.4840555276643*beta23-...
      180421403889152576811671101.7791698851443*beta21+...
      51279189973231073504244872.67955062715373*beta19-...
      12133309225897508197647088.13158097023916*beta17+...
      2351053544464708226209059.646161973384248*beta15-...
      365035401882750753980976.7544012525177095*beta13+...
      44092510836531525805831.75419040332781151*beta11-...
      3974644806550043938077.877350853510304458*beta9+...
      251394366394349134673.5194370871176943183*beta7-...
      10104318419973667709.45266343955881893635*beta5+...
      215234142639669188.8767808754928410053253*beta3;
Em1(1)=.4166666666666666666666666666666666666667e-1;
Em1(2)=0.;
Em1(3)= -.9722222222222222222222222222222222222222e-2;
Em1(4)= 0.;
Em1(5)= .1230158730158730158730158730158730158730e-1;
Em1(6)= 0.;
Em1(7)= -.3779761904761904761904761904761904761905e-1;
Em1(8)= 0.;
Em1(9)= .2150673400673400673400673400673400673401;
Em1(10)=0.;
Em1(11)=-1.962588800088800088800088800088800088800;
Em1(12)=0.;
Em1(13)=26.25320512820512820512820512820512820513;
Em1(14)=0.;
Em1(15)=-484.1431331699346405228758169934640522876;
Em1(16)=0.;
Em1(17)=11773.08376537749602765082641243631955706;
Em1(18)=0.;
Em1(19)=-365017.0548524720893141945773524720893142;
Em1(20)=0.;
Em1(21)= 4053914.86654589371980676328502415458937;
coefsum1=0;
coefsum2=Em1(1)/nu;
coefsum3=E(1)/nu;
for j=1:m
  coefsum1=coefsum1+E(2*j)/nu^(2*j);
  coefsum2=coefsum2+Em1(2*j+1)/nu^(2*j+1);
  coefsum3=coefsum3+E(2*j+1)/nu^(2*j+1);
end   
ji=1i*u*xi+(1/4)*(u+1)*pi+1i*coefsum3;   
Uazp=factorU*exp(coefsum1+coefsum2)*sin(ji);  
end  

